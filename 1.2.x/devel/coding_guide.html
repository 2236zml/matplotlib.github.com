

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Coding guide &mdash; Matplotlib 1.2.x documentation</title>
    
    <link rel="stylesheet" href="../_static/mpl.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.x',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Matplotlib 1.2.x documentation"
          href="../_static/opensearch.xml"/>
    <link rel="top" title="Matplotlib 1.2.x documentation" href="../index.html" />
    <link rel="up" title="The Matplotlib Developers’ Guide" href="index.html" />
    <link rel="next" title="Working with matplotlib source code" href="gitwash/index.html" />
    <link rel="prev" title="The Matplotlib Developers’ Guide" href="index.html" /> 
  </head>
  <body>
<!-- Piwik -->
<script type="text/javascript">
if ("matplotlib.sourceforge.net" == document.location.hostname ||
    "matplotlib.sf.net" == document.location.hostname) {
  var pkBaseURL = (("https:" == document.location.protocol) ? "https://apps.sourceforge.net/piwik/matplotlib/" : "http://apps.sourceforge.net/piwik/matplotlib/");
  document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
}
</script>
<script type="text/javascript">
if ("matplotlib.sourceforge.net" == document.location.hostname ||
    "matplotlib.sf.net" == document.location.hostname) {
  piwik_action_name = '';
  piwik_idsite = 1;
  piwik_url = pkBaseURL + "piwik.php";
  piwik_log(piwik_action_name, piwik_idsite, piwik_url);
  document.write(unescape('%3Cobject%3E%3Cnoscript%3E%3Cp%3E%3Cimg src="http://apps.sourceforge.net/piwik/matplotlib/piwik.php?idsite=1" alt="piwik"/%3E%3C/p%3E%3C/noscript%3E%3C/object%3E'));
}
</script>
<!-- End Piwik Tag -->
<link rel="shortcut icon" href="_static/favicon.ico">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/logo2.png" border="0" alt="matplotlib"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="gitwash/index.html" title="Working with matplotlib source code"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="The Matplotlib Developers’ Guide"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
        <li><a href="../examples/index.html">examples</a>|&nbsp;</li>
        <li><a href="../gallery.html">gallery</a>|&nbsp;</li>
        <li><a href="../contents.html">docs</a> &raquo;</li>

          <li><a href="index.html" accesskey="U">The Matplotlib Developers&#8217; Guide</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Coding guide</a><ul>
<li><a class="reference internal" href="#committing-changes">Committing changes</a></li>
<li><a class="reference internal" href="#style-guide">Style guide</a><ul>
<li><a class="reference internal" href="#importing-and-name-spaces">Importing and name spaces</a></li>
<li><a class="reference internal" href="#naming-spacing-and-formatting-conventions">Naming, spacing, and formatting conventions</a></li>
<li><a class="reference internal" href="#keyword-argument-processing">Keyword argument processing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#documentation-and-docstrings">Documentation and docstrings</a></li>
<li><a class="reference internal" href="#developing-a-new-backend">Developing a new backend</a></li>
<li><a class="reference internal" href="#writing-examples">Writing examples</a></li>
<li><a class="reference internal" href="#writing-a-new-pyplot-function">Writing a new pyplot function</a></li>
<li><a class="reference internal" href="#testing">Testing</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#running-the-tests">Running the tests</a></li>
<li><a class="reference internal" href="#writing-a-simple-test">Writing a simple test</a></li>
<li><a class="reference internal" href="#writing-an-image-comparison-test">Writing an image comparison test</a></li>
<li><a class="reference internal" href="#known-failing-tests">Known failing tests</a></li>
<li><a class="reference internal" href="#creating-a-new-module-in-matplotlib-tests">Creating a new module in matplotlib.tests</a></li>
<li><a class="reference internal" href="#using-tox">Using tox</a></li>
<li><a class="reference internal" href="#using-travis-ci">Using Travis CI</a></li>
</ul>
</li>
<li><a class="reference internal" href="#licenses">Licenses</a><ul>
<li><a class="reference internal" href="#why-bsd-compatible">Why BSD compatible?</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">The Matplotlib Developers&#8217; Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="gitwash/index.html"
                        title="next chapter">Working with <em>matplotlib</em> source code</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/devel/coding_guide.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="coding-guide">
<span id="id1"></span><h1>Coding guide<a class="headerlink" href="#coding-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="committing-changes">
<h2>Committing changes<a class="headerlink" href="#committing-changes" title="Permalink to this headline">¶</a></h2>
<p>When committing changes to matplotlib, there are a few things to bear
in mind.</p>
<ul class="simple">
<li>if your changes are non-trivial, please make an entry in the
<tt class="file docutils literal"><span class="pre">CHANGELOG</span></tt></li>
<li>if you change the API, please document it in <tt class="file docutils literal"><span class="pre">doc/api/api_changes.rst</span></tt>,
and consider posting to <a class="reference external" href="http://lists.sourceforge.net/mailman/listinfo/matplotlib-devel">matplotlib-devel</a></li>
<li>Are your changes python2.6 compatible?  We support python2.6 and later</li>
<li>Can you pass <tt class="file docutils literal"><span class="pre">examples/tests/backend_driver.py</span></tt>?  This is our
poor man&#8217;s unit test.</li>
<li>Can you add a test to <tt class="file docutils literal"><span class="pre">lib/matplotlib/tests</span></tt> to test your changes?</li>
<li>If you have altered extension code, do you pass
<tt class="file docutils literal"><span class="pre">unit/memleak_hawaii3.py</span></tt>?</li>
<li>if you have added new files or directories, or reorganized existing
ones, are the new files included in the match patterns in
<tt class="file docutils literal"><span class="pre">MANIFEST.in</span></tt>.  This file determines what goes into the source
distribution of the mpl build.</li>
<li>Keep the maintenance branches and master in sync where it makes sense.</li>
</ul>
</div>
<div class="section" id="style-guide">
<h2>Style guide<a class="headerlink" href="#style-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="importing-and-name-spaces">
<h3>Importing and name spaces<a class="headerlink" href="#importing-and-name-spaces" title="Permalink to this headline">¶</a></h3>
<p>For <a class="reference external" href="http://www.numpy.org">numpy</a>, use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>For masked arrays, use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy.ma</span> <span class="kn">as</span> <span class="nn">ma</span>
</pre></div>
</div>
<p>For matplotlib main module, use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="kn">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;xtick.major.pad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
<p>For matplotlib modules (or any other modules), use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.cbook</span> <span class="kn">as</span> <span class="nn">cbook</span>

<span class="k">if</span> <span class="n">cbook</span><span class="o">.</span><span class="n">iterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>We prefer this over the equivalent <tt class="docutils literal"><span class="pre">from</span> <span class="pre">matplotlib</span> <span class="pre">import</span> <span class="pre">cbook</span></tt>
because the latter is ambiguous as to whether <tt class="docutils literal"><span class="pre">cbook</span></tt> is a module or a
function.  The former makes it explicit that you
are importing a module or package.  There are some modules with names
that match commonly used local variable names, eg
<a class="reference internal" href="../api/artist_api.html#module-matplotlib.lines" title="matplotlib.lines"><tt class="xref py py-mod docutils literal"><span class="pre">matplotlib.lines</span></tt></a> or <a class="reference internal" href="../api/colors_api.html#module-matplotlib.colors" title="matplotlib.colors"><tt class="xref py py-mod docutils literal"><span class="pre">matplotlib.colors</span></tt></a>. To avoid the clash,
use the prefix &#8216;m&#8217; with the <tt class="docutils literal"><span class="pre">import</span> <span class="pre">some.thing</span> <span class="pre">as</span>
<span class="pre">mthing</span></tt> syntax, eg:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.lines</span> <span class="kn">as</span> <span class="nn">mlines</span>
<span class="kn">import</span> <span class="nn">matplotlib.transforms</span> <span class="kn">as</span> <span class="nn">transforms</span>   <span class="c"># OK</span>
<span class="kn">import</span> <span class="nn">matplotlib.transforms</span> <span class="kn">as</span> <span class="nn">mtransforms</span>  <span class="c"># OK, if you want to disambiguate</span>
<span class="kn">import</span> <span class="nn">matplotlib.transforms</span> <span class="kn">as</span> <span class="nn">mtrans</span>       <span class="c"># OK, if you want to abbreviate</span>
</pre></div>
</div>
</div>
<div class="section" id="naming-spacing-and-formatting-conventions">
<h3>Naming, spacing, and formatting conventions<a class="headerlink" href="#naming-spacing-and-formatting-conventions" title="Permalink to this headline">¶</a></h3>
<p>In general, we want to hew as closely as possible to the standard
coding guidelines for python written by Guido in <a class="reference external" href="http://www.python.org/dev/peps/pep-0008">PEP 0008</a>, though we do not do this
throughout.</p>
<ul class="simple">
<li>functions and class methods: <tt class="docutils literal"><span class="pre">lower</span></tt> or
<tt class="docutils literal"><span class="pre">lower_underscore_separated</span></tt></li>
<li>attributes and variables: <tt class="docutils literal"><span class="pre">lower</span></tt> or <tt class="docutils literal"><span class="pre">lowerUpper</span></tt></li>
<li>classes: <tt class="docutils literal"><span class="pre">Upper</span></tt> or <tt class="docutils literal"><span class="pre">MixedCase</span></tt></li>
</ul>
<p>Prefer the shortest names that are still readable.</p>
<p>Configure your editor to use spaces, not hard tabs. The standard
indentation unit is always four spaces;
if there is a file with
tabs or a different number of spaces it is a bug &#8211; please fix it.
To detect and fix these and other whitespace errors (see below),
use <a class="reference external" href="http://svn.python.org/projects/doctools/trunk/utils/reindent.py">reindent.py</a> as
a command-line script.  Unless you are sure your editor always
does the right thing, please use reindent.py before committing your
changes in git.</p>
<p>Keep <a class="reference internal" href="#docstrings">docstrings</a> uniformly indented as in the example below, with
nothing to the left of the triple quotes.  The
<a class="reference internal" href="../api/cbook_api.html#matplotlib.cbook.dedent" title="matplotlib.cbook.dedent"><tt class="xref py py-func docutils literal"><span class="pre">matplotlib.cbook.dedent()</span></tt></a> function is needed to remove excess
indentation only if something will be interpolated into the docstring,
again as in the example below.</p>
<p>Limit line length to 80 characters.  If a logical line needs to be
longer, use parentheses to break it; do not use an escaped newline.
It may be preferable to use a temporary variable to replace a single
long line with two shorter and more readable lines.</p>
<p>Please do not commit lines with trailing white space, as it causes
noise in git diffs.  Tell your editor to strip whitespace from line
ends when saving a file.  If you are an emacs user, the following in
your <tt class="docutils literal"><span class="pre">.emacs</span></tt> will cause emacs to strip trailing white space upon
saving for python, C and C++:</p>
<div class="highlight-cl"><div class="highlight"><pre><span class="c1">; and similarly for c++-mode-hook and c-mode-hook</span>
<span class="p">(</span><span class="nv">add-hook</span> <span class="ss">&#39;python-mode-hook</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
          <span class="p">(</span><span class="nv">add-hook</span> <span class="ss">&#39;write-file-functions</span> <span class="ss">&#39;delete-trailing-whitespace</span><span class="p">)))</span>
</pre></div>
</div>
<p>for older versions of emacs (emacs&lt;22) you need to do:</p>
<div class="highlight-cl"><div class="highlight"><pre><span class="p">(</span><span class="nv">add-hook</span> <span class="ss">&#39;python-mode-hook</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
          <span class="p">(</span><span class="nv">add-hook</span> <span class="ss">&#39;local-write-file-hooks</span> <span class="ss">&#39;delete-trailing-whitespace</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="keyword-argument-processing">
<h3>Keyword argument processing<a class="headerlink" href="#keyword-argument-processing" title="Permalink to this headline">¶</a></h3>
<p>Matplotlib makes extensive use of <tt class="docutils literal"><span class="pre">**kwargs</span></tt> for pass-through
customizations from one function to another.  A typical example is in
<tt class="xref py py-func docutils literal"><span class="pre">matplotlib.pylab.text()</span></tt>.  The definition of the pylab text
function is a simple pass-through to
<a class="reference internal" href="../api/axes_api.html#matplotlib.axes.Axes.text" title="matplotlib.axes.Axes.text"><tt class="xref py py-meth docutils literal"><span class="pre">matplotlib.axes.Axes.text()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># in pylab.py</span>
<span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span>  <span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">draw_if_interactive</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ret</span>
</pre></div>
</div>
<p><a class="reference internal" href="../api/axes_api.html#matplotlib.axes.Axes.text" title="matplotlib.axes.Axes.text"><tt class="xref py py-meth docutils literal"><span class="pre">text()</span></tt></a> in simplified form looks like this,
i.e., it just passes all <tt class="docutils literal"><span class="pre">args</span></tt> and <tt class="docutils literal"><span class="pre">kwargs</span></tt> on to
<tt class="xref py py-meth docutils literal"><span class="pre">matplotlib.text.Text.__init__()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># in axes.py</span>
<span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">withdash</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>and <tt class="xref py py-meth docutils literal"><span class="pre">__init__()</span></tt> (again with liberties for
illustration) just passes them on to the
<a class="reference internal" href="../api/artist_api.html#matplotlib.artist.Artist.update" title="matplotlib.artist.Artist.update"><tt class="xref py py-meth docutils literal"><span class="pre">matplotlib.artist.Artist.update()</span></tt></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># in text.py</span>
<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">Artist</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">update</span></tt> does the work looking for methods named like
<tt class="docutils literal"><span class="pre">set_property</span></tt> if <tt class="docutils literal"><span class="pre">property</span></tt> is a keyword argument.  I.e., no one
looks at the keywords, they just get passed through the API to the
artist constructor which looks for suitably named methods and calls
them with the value.</p>
<p>As a general rule, the use of <tt class="docutils literal"><span class="pre">**kwargs</span></tt> should be reserved for
pass-through keyword arguments, as in the example above.  If all the
keyword args are to be used in the function, and not passed
on, use the key/value keyword args in the function definition rather
than the <tt class="docutils literal"><span class="pre">**kwargs</span></tt> idiom.</p>
<p>In some cases, you may want to consume some keys in the local
function, and let others pass through.  You can <tt class="docutils literal"><span class="pre">pop</span></tt> the ones to be
used locally and pass on the rest.  For example, in
<a class="reference internal" href="../api/axes_api.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot"><tt class="xref py py-meth docutils literal"><span class="pre">plot()</span></tt></a>, <tt class="docutils literal"><span class="pre">scalex</span></tt> and <tt class="docutils literal"><span class="pre">scaley</span></tt> are
local arguments and the rest are passed on as
<a class="reference internal" href="../api/artist_api.html#matplotlib.lines.Line2D" title="matplotlib.lines.Line2D"><tt class="xref py py-meth docutils literal"><span class="pre">Line2D()</span></tt></a> keyword arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># in axes.py</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">scalex</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;scalex&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">scaley</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;scaley&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hold</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_lines</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: there is a use case when <tt class="docutils literal"><span class="pre">kwargs</span></tt> are meant to be used locally
in the function (not passed on), but you still need the <tt class="docutils literal"><span class="pre">**kwargs</span></tt>
idiom.  That is when you want to use <tt class="docutils literal"><span class="pre">*args</span></tt> to allow variable
numbers of non-keyword args.  In this case, python will not allow you
to use named keyword args after the <tt class="docutils literal"><span class="pre">*args</span></tt> usage, so you will be
forced to use <tt class="docutils literal"><span class="pre">**kwargs</span></tt>.  An example is
<tt class="xref py py-meth docutils literal"><span class="pre">matplotlib.contour.ContourLabeler.clabel()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># in contour.py</span>
<span class="k">def</span> <span class="nf">clabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;fontsize&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">inline</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;inline&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fmt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;fmt&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%1.3f</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;colors&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
       <span class="o">...</span><span class="n">etc</span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="documentation-and-docstrings">
<span id="docstrings"></span><h2>Documentation and docstrings<a class="headerlink" href="#documentation-and-docstrings" title="Permalink to this headline">¶</a></h2>
<p>Matplotlib uses artist introspection of docstrings to support
properties.  All properties that you want to support through <tt class="docutils literal"><span class="pre">setp</span></tt>
and <tt class="docutils literal"><span class="pre">getp</span></tt> should have a <tt class="docutils literal"><span class="pre">set_property</span></tt> and <tt class="docutils literal"><span class="pre">get_property</span></tt>
method in the <a class="reference internal" href="../api/artist_api.html#matplotlib.artist.Artist" title="matplotlib.artist.Artist"><tt class="xref py py-class docutils literal"><span class="pre">Artist</span></tt></a> class.  Yes, this is
not ideal given python properties or enthought traits, but it is a
historical legacy for now.  The setter methods use the docstring with
the ACCEPTS token to indicate the type of argument the method accepts.
Eg. in <a class="reference internal" href="../api/artist_api.html#matplotlib.lines.Line2D" title="matplotlib.lines.Line2D"><tt class="xref py py-class docutils literal"><span class="pre">matplotlib.lines.Line2D</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># in lines.py</span>
<span class="k">def</span> <span class="nf">set_linestyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linestyle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the linestyle of the line</span>

<span class="sd">    ACCEPTS: [ &#39;-&#39; | &#39;--&#39; | &#39;-.&#39; | &#39;:&#39; | &#39;steps&#39; | &#39;None&#39; | &#39; &#39; | &#39;&#39; ]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Since matplotlib uses a lot of pass-through <tt class="docutils literal"><span class="pre">kwargs</span></tt>, eg. in every
function that creates a line (<a class="reference internal" href="../api/pyplot_api.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot"><tt class="xref py py-func docutils literal"><span class="pre">plot()</span></tt></a>,
<a class="reference internal" href="../api/pyplot_api.html#matplotlib.pyplot.semilogx" title="matplotlib.pyplot.semilogx"><tt class="xref py py-func docutils literal"><span class="pre">semilogx()</span></tt></a>,
<a class="reference internal" href="../api/pyplot_api.html#matplotlib.pyplot.semilogy" title="matplotlib.pyplot.semilogy"><tt class="xref py py-func docutils literal"><span class="pre">semilogy()</span></tt></a>, etc...), it can be difficult for
the new user to know which <tt class="docutils literal"><span class="pre">kwargs</span></tt> are supported.  Matplotlib uses
a docstring interpolation scheme to support documentation of every
function that takes a <tt class="docutils literal"><span class="pre">**kwargs</span></tt>.  The requirements are:</p>
<ol class="arabic simple">
<li>single point of configuration so changes to the properties don&#8217;t
require multiple docstring edits.</li>
<li>as automated as possible so that as properties change, the docs
are updated automagically.</li>
</ol>
<p>The functions <tt class="xref py py-attr docutils literal"><span class="pre">matplotlib.artist.kwdocd</span></tt> and
<a class="reference internal" href="../api/artist_api.html#matplotlib.artist.kwdoc" title="matplotlib.artist.kwdoc"><tt class="xref py py-func docutils literal"><span class="pre">matplotlib.artist.kwdoc()</span></tt></a> to facilitate this.  They combine
python string interpolation in the docstring with the matplotlib
artist introspection facility that underlies <tt class="docutils literal"><span class="pre">setp</span></tt> and <tt class="docutils literal"><span class="pre">getp</span></tt>.
The <tt class="docutils literal"><span class="pre">kwdocd</span></tt> is a single dictionary that maps class name to a
docstring of <tt class="docutils literal"><span class="pre">kwargs</span></tt>.  Here is an example from
<a class="reference internal" href="../api/artist_api.html#module-matplotlib.lines" title="matplotlib.lines"><tt class="xref py py-mod docutils literal"><span class="pre">matplotlib.lines</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># in lines.py</span>
<span class="n">artist</span><span class="o">.</span><span class="n">kwdocd</span><span class="p">[</span><span class="s">&#39;Line2D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">artist</span><span class="o">.</span><span class="n">kwdoc</span><span class="p">(</span><span class="n">Line2D</span><span class="p">)</span>
</pre></div>
</div>
<p>Then in any function accepting <a class="reference internal" href="../api/artist_api.html#matplotlib.lines.Line2D" title="matplotlib.lines.Line2D"><tt class="xref py py-class docutils literal"><span class="pre">Line2D</span></tt></a>
pass-through <tt class="docutils literal"><span class="pre">kwargs</span></tt>, eg. <a class="reference internal" href="../api/axes_api.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot"><tt class="xref py py-meth docutils literal"><span class="pre">matplotlib.axes.Axes.plot()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># in axes.py</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Some stuff omitted</span>

<span class="sd">    The kwargs are Line2D properties:</span>
<span class="sd">    %(Line2D)s</span>

<span class="sd">    kwargs scalex and scaley, if defined, are passed on</span>
<span class="sd">    to autoscale_view to determine whether the x and y axes are</span>
<span class="sd">    autoscaled; default True.  See Axes.autoscale_view for more</span>
<span class="sd">    information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
<span class="n">plot</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span> <span class="o">%</span> <span class="n">artist</span><span class="o">.</span><span class="n">kwdocd</span>
</pre></div>
</div>
<p>Note there is a problem for <a class="reference internal" href="../api/artist_api.html#matplotlib.artist.Artist" title="matplotlib.artist.Artist"><tt class="xref py py-class docutils literal"><span class="pre">Artist</span></tt></a>
<tt class="docutils literal"><span class="pre">__init__</span></tt> methods, eg. <tt class="xref py py-meth docutils literal"><span class="pre">matplotlib.patches.Patch.__init__()</span></tt>,
which supports <tt class="docutils literal"><span class="pre">Patch</span></tt> <tt class="docutils literal"><span class="pre">kwargs</span></tt>, since the artist inspector cannot
work until the class is fully defined and we can&#8217;t modify the
<tt class="docutils literal"><span class="pre">Patch.__init__.__doc__</span></tt> docstring outside the class definition.
There are some some manual hacks in this case, violating the
&#8220;single entry point&#8221; requirement above &#8211; see the
<tt class="docutils literal"><span class="pre">artist.kwdocd['Patch']</span></tt> setting in <a class="reference internal" href="../api/artist_api.html#module-matplotlib.patches" title="matplotlib.patches"><tt class="xref py py-mod docutils literal"><span class="pre">matplotlib.patches</span></tt></a>.</p>
</div>
<div class="section" id="developing-a-new-backend">
<span id="custom-backend"></span><h2>Developing a new backend<a class="headerlink" href="#developing-a-new-backend" title="Permalink to this headline">¶</a></h2>
<p>If you are working on a custom backend, the <em>backend</em> setting in
<tt class="file docutils literal"><span class="pre">matplotlibrc</span></tt> (<a class="reference internal" href="../users/customizing.html#customizing-matplotlib"><em>Customizing matplotlib</em></a>) supports an
external backend via the <tt class="docutils literal"><span class="pre">module</span></tt> directive.  if
<tt class="file docutils literal"><span class="pre">my_backend.py</span></tt> is a matplotlib backend in your
<span class="target" id="index-0"></span><a class="reference internal" href="../faq/environment_variables_faq.html#envvar-PYTHONPATH"><tt class="xref std std-envvar docutils literal"><span class="pre">PYTHONPATH</span></tt></a>, you can set use it on one of several ways</p>
<ul>
<li><p class="first">in matplotlibrc:</p>
<div class="highlight-python"><pre>backend : module://my_backend</pre>
</div>
</li>
<li><p class="first">with the use directive is your script:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">&#39;module://my_backend&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">from the command shell with the -d flag:</p>
<div class="highlight-python"><pre>&gt; python simple_plot.py -d module://my_backend</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="writing-examples">
<span id="sample-data"></span><h2>Writing examples<a class="headerlink" href="#writing-examples" title="Permalink to this headline">¶</a></h2>
<p>We have hundreds of examples in subdirectories of
<tt class="file docutils literal"><span class="pre">matplotlib/examples</span></tt>, and these are automatically
generated when the website is built to show up both in the <a class="reference external" href="http://matplotlib.sourceforge.net/examples/index.html">examples</a> and <a class="reference external" href="http://matplotlib.sourceforge.net/gallery.html">gallery</a> sections of the
website.  Many people find these examples from the website, and do not
have ready access to the file:<cite>examples</cite> directory in which they
reside.  Thus any example data that is required for the example should
be added to the <a class="reference external" href="https://github.com/matplotlib/sample_data">sample_data</a> git repository.
Then in your example code you can load it into a file handle with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.cbook</span> <span class="kn">as</span> <span class="nn">cbook</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">get_sample_data</span><span class="p">(</span><span class="s">&#39;mydata.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The file will be fetched from the git repo using urllib and updated
when the revision number changes.</p>
<p>If you prefer just to get the full path to the file instead of a file
object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.cbook</span> <span class="kn">as</span> <span class="nn">cbook</span>
<span class="n">datafile</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">get_sample_data</span><span class="p">(</span><span class="s">&#39;mydata.dat&#39;</span><span class="p">,</span> <span class="n">asfileobj</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;datafile&#39;</span><span class="p">,</span> <span class="n">datafile</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-a-new-pyplot-function">
<h2>Writing a new pyplot function<a class="headerlink" href="#writing-a-new-pyplot-function" title="Permalink to this headline">¶</a></h2>
<p>A large portion of the pyplot interface is automatically generated by the
<cite>boilerplate.py</cite> script (in the root of the source tree).  To add or remove
a plotting method from pyplot, edit the appropriate list in <cite>boilerplate.py</cite>
and then run the script which will update the content in
<cite>lib/matplotlib/pyplot.py</cite>. Both the changes in <cite>boilerplate.py</cite> and
<cite>lib/matplotlib/pyplot.py</cite> should be checked into the repository.</p>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>Matplotlib has a testing infrastructure based on <a class="reference external" href="http://somethingaboutorange.com/mrl/projects/nose/">nose</a>, making it easy
to write new tests. The tests are in <tt class="xref py py-mod docutils literal"><span class="pre">matplotlib.tests</span></tt>, and
customizations to the nose testing infrastructure are in
<tt class="xref py py-mod docutils literal"><span class="pre">matplotlib.testing</span></tt>. (There is other old testing cruft around,
please ignore it while we consolidate our testing to these locations.)</p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>The following software is required to run the tests:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://somethingaboutorange.com/mrl/projects/nose/">nose</a>, version 1.0 or later</li>
<li><a class="reference external" href="http://pages.cs.wisc.edu/~ghost/">Ghostscript</a> (to render PDF
files)</li>
<li><a class="reference external" href="http://inkscape.org">Inkscape</a> (to render SVG files)</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="running-the-tests">
<h3>Running the tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h3>
<p>Running the tests is simple. Make sure you have nose installed and run
the script <tt class="file docutils literal"><span class="pre">tests.py</span></tt> in the root directory of the distribution.
The script can take any of the usual <a class="reference external" href="http://somethingaboutorange.com/mrl/projects/nose/1.0.0/usage.html">nosetest arguments</a>, such as</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">-v</span></tt></td>
<td>increase verbosity</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">-d</span></tt></td>
<td>detailed error messages</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">--with-coverage</span></tt></td>
<td>enable collecting coverage information</td>
</tr>
</tbody>
</table>
<p>To run a single test from the command line, you can provide a
dot-separated path to the module followed by the function separated by
a colon, eg.  (this is assuming the test is installed):</p>
<div class="highlight-python"><pre>python tests.py matplotlib.tests.test_simplification:test_clipping</pre>
</div>
<p>An alternative implementation that does not look at command line
arguments works from within Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
<p>Running tests by any means other than <cite>matplotlib.test()</cite>
does not load the nose &#8220;knownfailureif&#8221; (Known failing tests) plugin,
causing known-failing tests to fail for real.</p>
</div>
<div class="section" id="writing-a-simple-test">
<h3>Writing a simple test<a class="headerlink" href="#writing-a-simple-test" title="Permalink to this headline">¶</a></h3>
<p>Many elements of Matplotlib can be tested using standard tests. For
example, here is a test from <tt class="xref py py-mod docutils literal"><span class="pre">matplotlib.tests.test_basic</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">nose.tools</span> <span class="kn">import</span> <span class="n">assert_equal</span>

<span class="k">def</span> <span class="nf">test_simple</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;very simple example test&#39;&#39;&#39;</span>
    <span class="n">assert_equal</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Nose determines which functions are tests by searching for functions
beginning with &#8220;test&#8221; in their name.</p>
</div>
<div class="section" id="writing-an-image-comparison-test">
<h3>Writing an image comparison test<a class="headerlink" href="#writing-an-image-comparison-test" title="Permalink to this headline">¶</a></h3>
<p>Writing an image based test is only slightly more difficult than a
simple test. The main consideration is that you must specify the
&#8220;baseline&#8221;, or expected, images in the
<tt class="xref py py-func docutils literal"><span class="pre">image_comparison()</span></tt> decorator. For
example, this test generates a single image and automatically tests
it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib.testing.decorators</span> <span class="kn">import</span> <span class="n">image_comparison</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="nd">@image_comparison</span><span class="p">(</span><span class="n">baseline_images</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;spines_axes_positions&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test_spines_axes_positions</span><span class="p">():</span>
    <span class="c"># SF bug 2852168</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;centered spines&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s">&#39;axes&#39;</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s">&#39;axes&#39;</span><span class="p">,</span><span class="mf">0.25</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">&#39;top&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The first time this test is run, there will be no baseline image to
compare against, so the test will fail.  Copy the output images (in
this case <cite>result_images/test_category/spines_axes_positions.*</cite>) to
the <cite>baseline_images</cite> tree in the source directory (in this case
<cite>lib/matplotlib/tests/baseline_images/test_category</cite>) and put them
under source code revision control (with <cite>git add</cite>).  When rerunning
the tests, they should now pass.</p>
<p>There are two optional keyword arguments to the <cite>image_comparison</cite>
decorator:</p>
<blockquote>
<div><ul class="simple">
<li><cite>extensions</cite>: If you only wish to test some of the image formats
(rather than the default <cite>png</cite>, <cite>svg</cite> and <cite>pdf</cite> formats), pass a
list of the extensions to test.</li>
<li><cite>tol</cite>: This is the image matching tolerance, the default <cite>1e-3</cite>.
If some variation is expected in the image between runs, this
value may be adjusted.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="known-failing-tests">
<h3>Known failing tests<a class="headerlink" href="#known-failing-tests" title="Permalink to this headline">¶</a></h3>
<p>If you&#8217;re writing a test, you may mark it as a known failing test with
the <tt class="xref py py-func docutils literal"><span class="pre">knownfailureif()</span></tt>
decorator. This allows the test to be added to the test suite and run
on the buildbots without causing undue alarm. For example, although
the following test will fail, it is an expected failure:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">nose.tools</span> <span class="kn">import</span> <span class="n">assert_equal</span>
<span class="kn">from</span> <span class="nn">matplotlib.testing.decorators</span> <span class="kn">import</span> <span class="n">knownfailureif</span>

<span class="nd">@knownfailureif</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_simple_fail</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;very simple example test that should fail&#39;&#39;&#39;</span>
    <span class="n">assert_equal</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the first argument to the
<tt class="xref py py-func docutils literal"><span class="pre">knownfailureif()</span></tt> decorator is a
fail condition, which can be a value such as True, False, or
&#8216;indeterminate&#8217;, or may be a dynamically evaluated expression.</p>
</div>
<div class="section" id="creating-a-new-module-in-matplotlib-tests">
<h3>Creating a new module in matplotlib.tests<a class="headerlink" href="#creating-a-new-module-in-matplotlib-tests" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s say you&#8217;ve added a new module named
<tt class="docutils literal"><span class="pre">matplotlib.tests.test_whizbang_features</span></tt>.  To add this module to
the list of default tests, append its name to <tt class="docutils literal"><span class="pre">default_test_modules</span></tt>
in <tt class="file docutils literal"><span class="pre">lib/matplotlib/__init__.py</span></tt>.</p>
</div>
<div class="section" id="using-tox">
<h3>Using tox<a class="headerlink" href="#using-tox" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://tox.testrun.org/">Tox</a> is a tool for running tests against multiple
Python environments, including multiple versions of Python (e.g.: 2.6, 2.7,
3.2, etc.) and even different Python implementations altogether (e.g.: CPython,
PyPy, Jython, etc.)</p>
<p>Testing all 4 versions of Python (2.6, 2.7, 3.1, and 3.2) requires having four
versions of Python installed on your system and on the PATH. Depending on your
operating system, you may want to use your package manager (such as apt-get,
yum or MacPorts) to do this, or use <a class="reference external" href="https://github.com/utahta/pythonbrew">pythonbrew</a>.</p>
<p>tox makes it easy to determine if your working copy introduced any regressions
before submitting a pull request. Here&#8217;s how to use it:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip install tox
<span class="nv">$ </span>tox
</pre></div>
</div>
<p>You can also run tox on a subset of environments:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>tox -e py26,py27
</pre></div>
</div>
<p>Tox processes everything serially so it can take a long time to test several
environments. To speed it up, you might try using a new, parallelized version
of tox called <tt class="docutils literal"><span class="pre">detox</span></tt>. Give this a try:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip install -U -i http://pypi.testrun.org detox
<span class="nv">$ </span>detox
</pre></div>
</div>
<p>Tox is configured using a file called <tt class="docutils literal"><span class="pre">tox.ini</span></tt>. You may need to edit this
file if you want to add new environments to test (e.g.: <tt class="docutils literal"><span class="pre">py33</span></tt>) or if you
want to tweak the dependencies or the way the tests are run. For more info on
the <tt class="docutils literal"><span class="pre">tox.ini</span></tt> file, see the <a class="reference external" href="http://tox.testrun.org/latest/config.html">Tox Configuration Specification</a>.</p>
</div>
<div class="section" id="using-travis-ci">
<h3>Using Travis CI<a class="headerlink" href="#using-travis-ci" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://travis-ci.org/">Travis CI</a> is a hosted CI system &#8220;in the cloud&#8221;.</p>
<p>Travis is configured to receive notifications of new commits to GitHub repos
(via GitHub &#8220;service hooks&#8221;) and to run builds or tests when it sees these new
commits. It looks for a YAML file called <tt class="docutils literal"><span class="pre">.travis.yml</span></tt> in the root of the
repository to see how to test the project.</p>
<p>Travis CI is already enabled for the <a class="reference external" href="https://github.com/matplotlib/matplotlib/">main matplotlib GitHub repository</a> &#8211; for example, see <a class="reference external" href="http://travis-ci.org/#!/matplotlib/matplotlib">its Travis
page</a>.</p>
<p>If you want to enable Travis CI for your personal matplotlib GitHub repo,
simply enable the repo to use Travis CI in either the Travis CI UI or the
GitHub UI (Admin | Service Hooks). For details, see <a class="reference external" href="http://about.travis-ci.org/docs/user/getting-started/">the Travis CI Getting
Started page</a>.</p>
<p>Once this is configured, you can see the Travis CI results at
<a class="reference external" href="http://travis-ci.org/#!/your_GitHub_user_name/matplotlib">http://travis-ci.org/#!/your_GitHub_user_name/matplotlib</a> &#8211; here&#8217;s <a class="reference external" href="http://travis-ci.org/#!/msabramo/matplotlib">an example</a>.</p>
</div>
</div>
<div class="section" id="licenses">
<span id="license-discussion"></span><h2>Licenses<a class="headerlink" href="#licenses" title="Permalink to this headline">¶</a></h2>
<p>Matplotlib only uses BSD compatible code.  If you bring in code from
another project make sure it has a PSF, BSD, MIT or compatible license
(see the Open Source Initiative <a class="reference external" href="http://www.opensource.org/licenses">licenses page</a> for details on individual
licenses).  If it doesn&#8217;t, you may consider contacting the author and
asking them to relicense it.  GPL and LGPL code are not acceptable in
the main code base, though we are considering an alternative way of
distributing L/GPL code through an separate channel, possibly a
toolkit.  If you include code, make sure you include a copy of that
code&#8217;s license in the license directory if the code&#8217;s license requires
you to distribute the license with it.  Non-BSD compatible licenses
are acceptable in matplotlib toolkits (eg basemap), but make sure you
clearly state the licenses you are using.</p>
<div class="section" id="why-bsd-compatible">
<h3>Why BSD compatible?<a class="headerlink" href="#why-bsd-compatible" title="Permalink to this headline">¶</a></h3>
<p>The two dominant license variants in the wild are GPL-style and
BSD-style. There are countless other licenses that place specific
restrictions on code reuse, but there is an important difference to be
considered in the GPL and BSD variants.  The best known and perhaps
most widely used license is the GPL, which in addition to granting you
full rights to the source code including redistribution, carries with
it an extra obligation. If you use GPL code in your own code, or link
with it, your product must be released under a GPL compatible
license. I.e., you are required to give the source code to other
people and give them the right to redistribute it as well. Many of the
most famous and widely used open source projects are released under
the GPL, including linux, gcc, emacs and sage.</p>
<p>The second major class are the BSD-style licenses (which includes MIT
and the python PSF license). These basically allow you to do whatever
you want with the code: ignore it, include it in your own open source
project, include it in your proprietary product, sell it,
whatever. python itself is released under a BSD compatible license, in
the sense that, quoting from the PSF license page:</p>
<div class="highlight-python"><pre>There is no GPL-like "copyleft" restriction. Distributing
binary-only versions of Python, modified or not, is allowed. There
is no requirement to release any of your source code. You can also
write extension modules for Python and provide them only in binary
form.</pre>
</div>
<p>Famous projects released under a BSD-style license in the permissive
sense of the last paragraph are the BSD operating system, python and
TeX.</p>
<p>There are several reasons why early matplotlib developers selected a
BSD compatible license. matplotlib is a python extension, and we
choose a license that was based on the python license (BSD
compatible).  Also, we wanted to attract as many users and developers
as possible, and many software companies will not use GPL code in
software they plan to distribute, even those that are highly committed
to open source development, such as <a class="reference external" href="http://enthought.com">enthought</a>, out of legitimate concern that use of the
GPL will &#8220;infect&#8221; their code base by its viral nature. In effect, they
want to retain the right to release some proprietary code. Companies
and institutions who use matplotlib often make significant
contributions, because they have the resources to get a job done, even
a boring one. Two of the matplotlib backends (FLTK and WX) were
contributed by private companies.  The final reason behind the
licensing choice is compatibility with the other python extensions for
scientific computing: ipython, numpy, scipy, the enthought tool suite
and python itself are all distributed under BSD compatible licenses.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="gitwash/index.html" title="Working with matplotlib source code"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="The Matplotlib Developers’ Guide"
             >previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
        <li><a href="../examples/index.html">examples</a>|&nbsp;</li>
        <li><a href="../gallery.html">gallery</a>|&nbsp;</li>
        <li><a href="../contents.html">docs</a> &raquo;</li>

          <li><a href="index.html" >The Matplotlib Developers&#8217; Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008, John Hunter, Darren Dale, Michael Droettboom.
      Last updated on Aug 10, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>