<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>matplotlib.text &mdash; Matplotlib 3.1.2 documentation</title>
    
    <link rel="stylesheet" href="../../_static/mpl.css?v3.1.1-79-g90d53b526"
type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css"
type="text/css" />
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../../_static/copybutton.js"></script>
        <script type="text/javascript">var copybuttonSkipText = '>>> ';</script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Matplotlib 3.1.2 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html"
/>
    <link rel="search" title="Search" href="../../search.html"
/>
    <link rel="top" title="Matplotlib 3.1.2 documentation" href="../../index.html" />
    <link rel="up" title="matplotlib" href="../matplotlib.html" />
    <link rel="canonical" href="https://matplotlib.org/3.1.2/_modules/matplotlib/text.html" />



  </head>
  <body>



<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px; position: relative;">
<a href="../../index.html">
    <div style="float: left; position: absolute; width: 496px; bottom: 0; padding-bottom: 24px"><span style="float: right; color: #789; background: white">Version 3.1.2</span></div>
    <img src="../../_static/logo2_compressed.svg" height="125px" border="0" alt="matplotlib"/></a>

<!-- The "Fork me on github" ribbon -->
<div id="forkongithub"><a href="https://github.com/matplotlib/matplotlib">Fork me on GitHub</a></div>
</div>


<nav class="main-nav">
  <ul>
    <li><a href="../../users/installing.html">Installation</a></li>
    <li><a href="../../contents.html">Documentation</a></li>
    <li><a href="../../gallery/index.html">Examples</a></li>
    <li><a href="../../tutorials/index.html">Tutorials</a></li>
    <li><a href="../../devel/index.html">Contributing</a></li>
  </ul>
</nav>




    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>

        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../contents.html">contents</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../matplotlib.html" accesskey="U">matplotlib</a> &raquo;</li> 
      </ul>
    </div>

  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../contents.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  <li><a href="../matplotlib.html">matplotlib</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
        </div>
      </div>
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for matplotlib.text</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Classes for including text in a figure.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">contextlib</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">weakref</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">artist</span><span class="p">,</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">docstring</span><span class="p">,</span> <span class="n">rcParams</span>
<span class="kn">from</span> <span class="nn">.artist</span> <span class="kn">import</span> <span class="n">Artist</span>
<span class="kn">from</span> <span class="nn">.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
<span class="kn">from</span> <span class="nn">.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">from</span> <span class="nn">.patches</span> <span class="kn">import</span> <span class="n">FancyArrowPatch</span><span class="p">,</span> <span class="n">FancyBboxPatch</span><span class="p">,</span> <span class="n">Rectangle</span>
<span class="kn">from</span> <span class="nn">.textpath</span> <span class="kn">import</span> <span class="n">TextPath</span>  <span class="c1"># Unused, but imported by others.</span>
<span class="kn">from</span> <span class="nn">.transforms</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Affine2D</span><span class="p">,</span> <span class="n">Bbox</span><span class="p">,</span> <span class="n">BboxBase</span><span class="p">,</span> <span class="n">BboxTransformTo</span><span class="p">,</span> <span class="n">IdentityTransform</span><span class="p">,</span> <span class="n">Transform</span><span class="p">)</span>


<span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span> <span class="nf">_wrap_text</span><span class="p">(</span><span class="n">textobj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Temporarily inserts newlines to the text if the wrap option is enabled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">textobj</span><span class="o">.</span><span class="n">get_wrap</span><span class="p">():</span>
        <span class="n">old_text</span> <span class="o">=</span> <span class="n">textobj</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">textobj</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">textobj</span><span class="o">.</span><span class="n">_get_wrapped_text</span><span class="p">())</span>
            <span class="k">yield</span> <span class="n">textobj</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">textobj</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">old_text</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">textobj</span>


<span class="c1"># Extracted from Text&#39;s method to serve as a function</span>
<div class="viewcode-block" id="get_rotation"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.get_rotation">[docs]</a><span class="k">def</span> <span class="nf">get_rotation</span><span class="p">(</span><span class="n">rotation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the text angle as float between 0 and 360 degrees.</span>

<span class="sd">    *rotation* may be &#39;horizontal&#39;, &#39;vertical&#39;, or a numeric value in degrees.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_str_equal</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">rotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.</span>
        <span class="k">elif</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_str_equal</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;vertical&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="mf">90.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;rotation is </span><span class="si">{!r}</span><span class="s2">; expected either &#39;horizontal&#39;, &quot;</span>
                             <span class="s2">&quot;&#39;vertical&#39;, numeric value, or None&quot;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span></div>


<span class="k">def</span> <span class="nf">_get_textbox</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the bounding box of the text. Unlike</span>
<span class="sd">    :meth:`matplotlib.text.Text.get_extents` method, The bbox size of</span>
<span class="sd">    the text before the rotation is calculated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO : This function may move into the Text class as a method. As a</span>
    <span class="c1"># matter of fact, The information from the _get_textbox function</span>
    <span class="c1"># should be available during the Text._get_layout() call, which is</span>
    <span class="c1"># called within the _get_textbox. So, it would better to move this</span>
    <span class="c1"># function as a method with some refactoring of _get_layout method.</span>

    <span class="n">projected_xs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">projected_ys</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">())</span>
    <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">parts</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">_get_layout</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">wh</span>

        <span class="n">xt1</span><span class="p">,</span> <span class="n">yt1</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">yt1</span> <span class="o">-=</span> <span class="n">d</span>
        <span class="n">xt2</span><span class="p">,</span> <span class="n">yt2</span> <span class="o">=</span> <span class="n">xt1</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">yt1</span> <span class="o">+</span> <span class="n">h</span>

        <span class="n">projected_xs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">xt1</span><span class="p">,</span> <span class="n">xt2</span><span class="p">])</span>
        <span class="n">projected_ys</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">yt1</span><span class="p">,</span> <span class="n">yt2</span><span class="p">])</span>

    <span class="n">xt_box</span><span class="p">,</span> <span class="n">yt_box</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">projected_xs</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">projected_ys</span><span class="p">)</span>
    <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">projected_xs</span><span class="p">)</span> <span class="o">-</span> <span class="n">xt_box</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">projected_ys</span><span class="p">)</span> <span class="o">-</span> <span class="n">yt_box</span>

    <span class="n">x_box</span><span class="p">,</span> <span class="n">y_box</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">xt_box</span><span class="p">,</span> <span class="n">yt_box</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">x_box</span><span class="p">,</span> <span class="n">y_box</span><span class="p">,</span> <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span>


<div class="viewcode-block" id="Text"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text">[docs]</a><span class="nd">@cbook</span><span class="o">.</span><span class="n">_define_aliases</span><span class="p">({</span>
    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontfamily&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;family&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontproperties&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;font_properties&quot;</span><span class="p">],</span>
    <span class="s2">&quot;horizontalalignment&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ha&quot;</span><span class="p">],</span>
    <span class="s2">&quot;multialignment&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ma&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontname&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontstretch&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;stretch&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontstyle&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontvariant&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;variant&quot;</span><span class="p">],</span>
    <span class="s2">&quot;verticalalignment&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;va&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontweight&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">class</span> <span class="nc">Text</span><span class="p">(</span><span class="n">Artist</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Handle storing and drawing of text in window or data coordinates.&quot;&quot;&quot;</span>

    <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">_cached</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">maxdict</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Text(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>           <span class="c1"># defaults to rc params</span>
                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                 <span class="n">multialignment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">fontproperties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># defaults to FontProperties()</span>
                 <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">linespacing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">rotation_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">usetex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>          <span class="c1"># defaults to rcParams[&#39;text.usetex&#39;]</span>
                 <span class="n">wrap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a `.Text` instance at *x*, *y* with string *text*.</span>

<span class="sd">        Valid kwargs are</span>
<span class="sd">        %(Text)s</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Artist</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.color&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fontproperties</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fontproperties</span> <span class="o">=</span> <span class="n">FontProperties</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fontproperties</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">fontproperties</span> <span class="o">=</span> <span class="n">FontProperties</span><span class="p">(</span><span class="n">fontproperties</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_usetex</span><span class="p">(</span><span class="n">usetex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_wrap</span><span class="p">(</span><span class="n">wrap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_verticalalignment</span><span class="p">(</span><span class="n">verticalalignment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_horizontalalignment</span><span class="p">(</span><span class="n">horizontalalignment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span> <span class="o">=</span> <span class="n">multialignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="n">rotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span> <span class="o">=</span> <span class="n">fontproperties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># a FancyBboxPatch instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">linespacing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linespacing</span> <span class="o">=</span> <span class="mf">1.2</span>   <span class="c1"># Maybe use rcParam later.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span> <span class="o">=</span> <span class="n">linespacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_rotation_mode</span><span class="p">(</span><span class="n">rotation_mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Text.update"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update properties from a dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Update bbox last, as it depends on font properties.</span>
        <span class="n">sentinel</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>  <span class="c1"># bbox can be None, so use another sentinel.</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bbox&quot;</span><span class="p">,</span> <span class="n">sentinel</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">sentinel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>
        <span class="c1"># remove the cached _renderer (if it exists)</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;_renderer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">d</span>

<div class="viewcode-block" id="Text.contains"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Test whether the mouse event occurred in the patch.</span>

<span class="sd">        In the case of text, a hit is true anywhere in the</span>
<span class="sd">        axis-aligned bounding-box containing the text.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{}</span>

        <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">bounds</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">h</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">y</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">cattr</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># if the text has a surrounding patch, also check containment for it,</span>
        <span class="c1"># and merge the results with the results for the text.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>
            <span class="n">patch_inside</span><span class="p">,</span> <span class="n">patch_cattr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">mouseevent</span><span class="p">)</span>
            <span class="n">inside</span> <span class="o">=</span> <span class="n">inside</span> <span class="ow">or</span> <span class="n">patch_inside</span>
            <span class="n">cattr</span><span class="p">[</span><span class="s2">&quot;bbox_patch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">patch_cattr</span>

        <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="n">cattr</span></div>

    <span class="k">def</span> <span class="nf">_get_xy_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the (possibly unit converted) transformed x, y in display coords.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unitless_position</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_multialignment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span>

<div class="viewcode-block" id="Text.get_rotation"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_rotation">[docs]</a>    <span class="k">def</span> <span class="nf">get_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the text angle as float in degrees.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">get_rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="p">)</span>  <span class="c1"># string_or_number -&gt; number</span></div>

<div class="viewcode-block" id="Text.set_rotation_mode"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_rotation_mode">[docs]</a>    <span class="k">def</span> <span class="nf">set_rotation_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set text rotation mode.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        m : {None, &#39;default&#39;, &#39;anchor&#39;}</span>
<span class="sd">            If ``None`` or ``&quot;default&quot;``, the text will be first rotated, then</span>
<span class="sd">            aligned according to their horizontal and vertical alignments.  If</span>
<span class="sd">            ``&quot;anchor&quot;``, then alignment occurs before rotation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;anchor&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rotation_mode</span> <span class="o">=</span> <span class="n">m</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown rotation_mode : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.get_rotation_mode"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_rotation_mode">[docs]</a>    <span class="k">def</span> <span class="nf">get_rotation_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the text rotation mode.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation_mode</span></div>

<div class="viewcode-block" id="Text.update_from"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.update_from">[docs]</a>    <span class="k">def</span> <span class="nf">update_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy properties from other to self.&quot;&quot;&quot;</span>
        <span class="n">Artist</span><span class="o">.</span><span class="n">update_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_color</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_multialignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_verticalalignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_horizontalalignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_rotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_picker</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_picker</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_linespacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">_get_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return the extent (bbox) of the text together with</span>
<span class="sd">        multiple-alignment information. Note that it returns an extent</span>
<span class="sd">        of a rotated text when necessary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_prop_tup</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="n">thisx</span><span class="p">,</span> <span class="n">thisy</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Ensures lines is not empty.</span>

        <span class="n">ws</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">hs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Full vertical extent of font, including ascenders and descenders:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">lp_h</span><span class="p">,</span> <span class="n">lp_d</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">get_text_width_height_descent</span><span class="p">(</span>
            <span class="s2">&quot;lp&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">,</span>
            <span class="n">ismath</span><span class="o">=</span><span class="s2">&quot;TeX&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_usetex</span><span class="p">()</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">min_dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">lp_h</span> <span class="o">-</span> <span class="n">lp_d</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">clean_line</span><span class="p">,</span> <span class="n">ismath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_math</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">clean_line</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">get_text_width_height_descent</span><span class="p">(</span>
                    <span class="n">clean_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">,</span> <span class="n">ismath</span><span class="o">=</span><span class="n">ismath</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">h</span> <span class="o">=</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># For multiline text, increase the line spacing when the text</span>
            <span class="c1"># net-height (excluding baseline) is larger than that of a &quot;l&quot;</span>
            <span class="c1"># (e.g., use of superscripts), which seems what TeX does.</span>
            <span class="n">h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">lp_h</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">lp_d</span><span class="p">)</span>

            <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
            <span class="n">hs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

            <span class="c1"># Metrics of the last line that are needed later:</span>
            <span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="n">thisy</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># position at baseline</span>
                <span class="n">thisy</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># put baseline a good distance from bottom of previous line</span>
                <span class="n">thisy</span> <span class="o">-=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_dy</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span><span class="p">)</span>

            <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisx</span><span class="p">)</span>  <span class="c1"># == 0.</span>
            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisy</span><span class="p">)</span>

            <span class="n">thisy</span> <span class="o">-=</span> <span class="n">d</span>

        <span class="c1"># Metrics of the last line that are needed later:</span>
        <span class="n">descent</span> <span class="o">=</span> <span class="n">d</span>

        <span class="c1"># Bounding box definition:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">width</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">descent</span>  <span class="c1"># baseline of last line minus its descent</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span>

        <span class="c1"># get the rotation matrix</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">())</span>

        <span class="c1"># now offset the individual text lines within the box</span>
        <span class="n">malign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_multialignment</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">malign</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
            <span class="n">offset_layout</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">malign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
            <span class="n">offset_layout</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">ws</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">malign</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
            <span class="n">offset_layout</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">ws</span><span class="p">)]</span>

        <span class="c1"># the corners of the unrotated bounding box</span>
        <span class="n">corners_horiz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">),</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">)])</span>

        <span class="c1"># now rotate the bbox</span>
        <span class="n">corners_rotated</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corners_horiz</span><span class="p">)</span>
        <span class="c1"># compute the bounds of the rotated box</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="n">corners_rotated</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">corners_rotated</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">corners_rotated</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">corners_rotated</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span>

        <span class="c1"># Now move the box to the target position offset the display</span>
        <span class="c1"># bbox by alignment</span>
        <span class="n">halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span>
        <span class="n">valign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span>

        <span class="n">rotation_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotation_mode</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rotation_mode</span> <span class="o">!=</span> <span class="s2">&quot;anchor&quot;</span><span class="p">:</span>
            <span class="c1"># compute the text location in display coords and the offsets</span>
            <span class="c1"># necessary to align the bbox with that location</span>
            <span class="k">if</span> <span class="n">halign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin</span> <span class="o">+</span> <span class="n">xmax</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">halign</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="n">xmax</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="n">xmin</span>

            <span class="k">if</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymin</span> <span class="o">+</span> <span class="n">ymax</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymax</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;baseline&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="n">descent</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;center_baseline&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="n">baseline</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymin</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xmin1</span><span class="p">,</span> <span class="n">ymin1</span> <span class="o">=</span> <span class="n">corners_horiz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">xmax1</span><span class="p">,</span> <span class="n">ymax1</span> <span class="o">=</span> <span class="n">corners_horiz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">halign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin1</span> <span class="o">+</span> <span class="n">xmax1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="k">elif</span> <span class="n">halign</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="n">xmax1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="n">xmin1</span>

            <span class="k">if</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymin1</span> <span class="o">+</span> <span class="n">ymax1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymax1</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;baseline&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymax1</span> <span class="o">-</span> <span class="n">baseline</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;center_baseline&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymax1</span> <span class="o">-</span> <span class="n">baseline</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymin1</span>

            <span class="n">offsetx</span><span class="p">,</span> <span class="n">offsety</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">offsetx</span><span class="p">,</span> <span class="n">offsety</span><span class="p">))</span>

        <span class="n">xmin</span> <span class="o">-=</span> <span class="n">offsetx</span>
        <span class="n">ymin</span> <span class="o">-=</span> <span class="n">offsety</span>

        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

        <span class="c1"># now rotate the positions around the first x,y position</span>
        <span class="n">xys</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">offset_layout</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">offsetx</span><span class="p">,</span> <span class="n">offsety</span><span class="p">)</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">hs</span><span class="p">),</span> <span class="o">*</span><span class="n">xys</span><span class="o">.</span><span class="n">T</span><span class="p">)),</span> <span class="n">descent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
        <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="Text.set_bbox"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_bbox">[docs]</a>    <span class="k">def</span> <span class="nf">set_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rectprops</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw a bounding box around self.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rectprops : dict with properties for `.patches.FancyBboxPatch`</span>
<span class="sd">             The default boxstyle is &#39;square&#39;. The mutation</span>
<span class="sd">             scale of the `.patches.FancyBboxPatch` is set to the fontsize.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            t.set_bbox(dict(facecolor=&#39;red&#39;, alpha=0.5))</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">rectprops</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">rectprops</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">boxstyle</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;boxstyle&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pad&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">boxstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">boxstyle</span> <span class="o">=</span> <span class="s2">&quot;square&quot;</span>
                <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">pad</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># points</span>
                <span class="n">pad</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>  <span class="c1"># to fraction of font size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.3</span>

            <span class="c1"># boxstyle could be a callable or a string</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boxstyle</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;pad&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">boxstyle</span><span class="p">:</span>
                <span class="n">boxstyle</span> <span class="o">+=</span> <span class="s2">&quot;,pad=</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pad</span>

            <span class="n">bbox_transmuter</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bbox_transmuter&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span> <span class="o">=</span> <span class="n">FancyBboxPatch</span><span class="p">(</span>
                                    <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span>
                                    <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span>
                                    <span class="n">boxstyle</span><span class="o">=</span><span class="n">boxstyle</span><span class="p">,</span>
                                    <span class="n">bbox_transmuter</span><span class="o">=</span><span class="n">bbox_transmuter</span><span class="p">,</span>
                                    <span class="n">transform</span><span class="o">=</span><span class="n">IdentityTransform</span><span class="p">(),</span>
                                    <span class="o">**</span><span class="n">props</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_bbox_patch"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_bbox_patch">[docs]</a>    <span class="k">def</span> <span class="nf">get_bbox_patch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the bbox Patch, or None if the `.patches.FancyBboxPatch`</span>
<span class="sd">        is not made.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span></div>

<div class="viewcode-block" id="Text.update_bbox_position_size"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.update_bbox_position_size">[docs]</a>    <span class="k">def</span> <span class="nf">update_bbox_position_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the location and the size of the bbox.</span>

<span class="sd">        This method should be used when the position and size of the bbox needs</span>
<span class="sd">        to be updated before actually drawing the bbox.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>

            <span class="n">trans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span>

            <span class="c1"># don&#39;t use self.get_unitless_position here, which refers to text</span>
            <span class="c1"># position in Text, and dash position in TextWithDash:</span>
            <span class="n">posx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))</span>
            <span class="n">posy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">))</span>

            <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">))</span>

            <span class="n">x_box</span><span class="p">,</span> <span class="n">y_box</span><span class="p">,</span> <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span> <span class="o">=</span> <span class="n">_get_textbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">())</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">posx</span> <span class="o">+</span> <span class="n">x_box</span><span class="p">,</span> <span class="n">posy</span> <span class="o">+</span> <span class="n">y_box</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
            <span class="n">fontsize_in_pixel</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">set_mutation_scale</span><span class="p">(</span><span class="n">fontsize_in_pixel</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_draw_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the location and size of the bbox (`.patches.FancyBboxPatch`),</span>
<span class="sd">        and draw.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">x_box</span><span class="p">,</span> <span class="n">y_box</span><span class="p">,</span> <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span> <span class="o">=</span> <span class="n">_get_textbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">())</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">posx</span> <span class="o">+</span> <span class="n">x_box</span><span class="p">,</span> <span class="n">posy</span> <span class="o">+</span> <span class="n">y_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
        <span class="n">fontsize_in_pixel</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">set_mutation_scale</span><span class="p">(</span><span class="n">fontsize_in_pixel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_clip_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">clipprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">clip_box</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">clipbox</span><span class="p">,</span>
                         <span class="n">clip_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_clippath</span><span class="p">,</span>
                         <span class="n">clip_on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_clipon</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">clipprops</span><span class="p">)</span>

<div class="viewcode-block" id="Text.set_clip_box"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_clip_box">[docs]</a>    <span class="k">def</span> <span class="nf">set_clip_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clipbox</span><span class="p">):</span>
        <span class="c1"># docstring inherited.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_clip_box</span><span class="p">(</span><span class="n">clipbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.set_clip_path"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_clip_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_clip_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># docstring inherited.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_clip_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.set_clip_on"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_clip_on">[docs]</a>    <span class="k">def</span> <span class="nf">set_clip_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="c1"># docstring inherited.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_clip_on</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_wrap"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_wrap">[docs]</a>    <span class="k">def</span> <span class="nf">get_wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the wrapping state for the text.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap</span></div>

<div class="viewcode-block" id="Text.set_wrap"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_wrap">[docs]</a>    <span class="k">def</span> <span class="nf">set_wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wrap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the wrapping state for the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wrap : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wrap</span> <span class="o">=</span> <span class="n">wrap</span></div>

    <span class="k">def</span> <span class="nf">_get_wrap_line_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the maximum line width for wrapping text based on the current</span>
<span class="sd">        orientation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_position</span><span class="p">())</span>
        <span class="n">figure_box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>

        <span class="c1"># Calculate available width based on text alignment</span>
        <span class="n">alignment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_horizontalalignment</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_rotation_mode</span><span class="p">(</span><span class="s1">&#39;anchor&#39;</span><span class="p">)</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">()</span>

        <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dist_to_box</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">figure_box</span><span class="p">)</span>
        <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dist_to_box</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">180</span> <span class="o">+</span> <span class="n">rotation</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">figure_box</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
            <span class="n">line_width</span> <span class="o">=</span> <span class="n">left</span>
        <span class="k">elif</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
            <span class="n">line_width</span> <span class="o">=</span> <span class="n">right</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">line_width</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">line_width</span>

    <span class="k">def</span> <span class="nf">_get_dist_to_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">figure_box</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the distance from the given points to the boundaries of a</span>
<span class="sd">        rotated box, in pixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rotation</span> <span class="o">&gt;</span> <span class="mi">270</span><span class="p">:</span>
            <span class="n">quad</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">-</span> <span class="mi">270</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">quad</span><span class="p">))</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="p">(</span><span class="n">figure_box</span><span class="o">.</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">quad</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">rotation</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
            <span class="n">quad</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">-</span> <span class="mi">180</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">quad</span><span class="p">))</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">quad</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">rotation</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="n">quad</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">-</span> <span class="mi">90</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="p">(</span><span class="n">figure_box</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">quad</span><span class="p">))</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">quad</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="p">(</span><span class="n">figure_box</span><span class="o">.</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="p">(</span><span class="n">figure_box</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">rotation</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_rendered_text_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the width of a given text string, in pixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span><span class="o">.</span><span class="n">get_text_width_height_descent</span><span class="p">(</span>
            <span class="n">text</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_fontproperties</span><span class="p">(),</span>
            <span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_wrapped_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of the text with new lines added, so that</span>
<span class="sd">        the text is wrapped relative to the parent figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Not fit to handle breaking up latex syntax correctly, so</span>
        <span class="c1"># ignore latex for now.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_usetex</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>

        <span class="c1"># Build the line incrementally, for a more accurate measure of length</span>
        <span class="n">line_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_wrap_line_width</span><span class="p">()</span>
        <span class="n">wrapped_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">):</span>
            <span class="c1"># New lines in the user&#39;s test need to force a split, so that it&#39;s</span>
            <span class="c1"># not using the longest current line width in the line being built</span>
            <span class="n">sub_words</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_words</span><span class="p">)):</span>
                <span class="n">current_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_rendered_text_width</span><span class="p">(</span>
                    <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sub_words</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                <span class="c1"># Split long lines, and each newline found in the current word</span>
                <span class="k">if</span> <span class="n">current_width</span> <span class="o">&gt;</span> <span class="n">line_width</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">wrapped_str</span> <span class="o">+=</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

                <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">sub_words</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sub_words</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">wrapped_str</span> <span class="o">+</span> <span class="n">line</span>

<div class="viewcode-block" id="Text.draw"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.draw">[docs]</a>    <span class="nd">@artist</span><span class="o">.</span><span class="n">allow_rasterization</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draws the `.Text` object to the given *renderer*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="n">renderer</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">renderer</span><span class="o">.</span><span class="n">open_group</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gid</span><span class="p">())</span>

        <span class="k">with</span> <span class="n">_wrap_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">as</span> <span class="n">textobj</span><span class="p">:</span>
            <span class="n">bbox</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">descent</span> <span class="o">=</span> <span class="n">textobj</span><span class="o">.</span><span class="n">_get_layout</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="n">trans</span> <span class="o">=</span> <span class="n">textobj</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span>

            <span class="c1"># don&#39;t use textobj.get_position here, which refers to text</span>
            <span class="c1"># position in Text, and dash position in TextWithDash:</span>
            <span class="n">posx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">textobj</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="n">textobj</span><span class="o">.</span><span class="n">_x</span><span class="p">))</span>
            <span class="n">posy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">textobj</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="n">textobj</span><span class="o">.</span><span class="n">_y</span><span class="p">))</span>
            <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">posx</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">posy</span><span class="p">):</span>
                <span class="n">_log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;posx and posy should be finite values&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">canvasw</span><span class="p">,</span> <span class="n">canvash</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">get_canvas_width_height</span><span class="p">()</span>

            <span class="c1"># draw the FancyBboxPatch</span>
            <span class="k">if</span> <span class="n">textobj</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>
                <span class="n">textobj</span><span class="o">.</span><span class="n">_draw_bbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">)</span>

            <span class="n">gc</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">new_gc</span><span class="p">()</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">(</span><span class="n">textobj</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">textobj</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">())</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_url</span><span class="p">(</span><span class="n">textobj</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span>
            <span class="n">textobj</span><span class="o">.</span><span class="n">_set_gc_clip</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span>

            <span class="n">angle</span> <span class="o">=</span> <span class="n">textobj</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span>

                <span class="n">mtext</span> <span class="o">=</span> <span class="n">textobj</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">posx</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">posy</span>
                <span class="k">if</span> <span class="n">renderer</span><span class="o">.</span><span class="n">flipy</span><span class="p">():</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">canvash</span> <span class="o">-</span> <span class="n">y</span>
                <span class="n">clean_line</span><span class="p">,</span> <span class="n">ismath</span> <span class="o">=</span> <span class="n">textobj</span><span class="o">.</span><span class="n">_preprocess_math</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">textobj</span><span class="o">.</span><span class="n">get_path_effects</span><span class="p">():</span>
                    <span class="kn">from</span> <span class="nn">matplotlib.patheffects</span> <span class="kn">import</span> <span class="n">PathEffectRenderer</span>
                    <span class="n">textrenderer</span> <span class="o">=</span> <span class="n">PathEffectRenderer</span><span class="p">(</span>
                                        <span class="n">textobj</span><span class="o">.</span><span class="n">get_path_effects</span><span class="p">(),</span> <span class="n">renderer</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textrenderer</span> <span class="o">=</span> <span class="n">renderer</span>

                <span class="k">if</span> <span class="n">textobj</span><span class="o">.</span><span class="n">get_usetex</span><span class="p">():</span>
                    <span class="n">textrenderer</span><span class="o">.</span><span class="n">draw_tex</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">clean_line</span><span class="p">,</span>
                                          <span class="n">textobj</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span>
                                          <span class="n">mtext</span><span class="o">=</span><span class="n">mtext</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textrenderer</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">clean_line</span><span class="p">,</span>
                                           <span class="n">textobj</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span>
                                           <span class="n">ismath</span><span class="o">=</span><span class="n">ismath</span><span class="p">,</span> <span class="n">mtext</span><span class="o">=</span><span class="n">mtext</span><span class="p">)</span>

        <span class="n">gc</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
        <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Text.get_color"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_color">[docs]</a>    <span class="k">def</span> <span class="nf">get_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Return the color of the text&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_color</span></div>

<div class="viewcode-block" id="Text.get_fontproperties"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_fontproperties">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontproperties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Return the `.font_manager.FontProperties` object&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span></div>

<div class="viewcode-block" id="Text.get_fontfamily"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_fontfamily">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontfamily</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the list of font families used for font lookup</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_family</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_family</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontname"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_fontname">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font name as string</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontstyle"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_fontstyle">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font style as string</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_style</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_style</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontsize"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_fontsize">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font size as integer</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_size_in_points</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_size_in_points</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontvariant"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_fontvariant">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontvariant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font variant as a string</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_variant</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_variant</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontweight"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_fontweight">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontweight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the font weight as string or number</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_weight</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_weight</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_stretch"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_stretch">[docs]</a>    <span class="k">def</span> <span class="nf">get_stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the font stretch as a string or number</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_stretch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_stretch</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_horizontalalignment"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_horizontalalignment">[docs]</a>    <span class="k">def</span> <span class="nf">get_horizontalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the horizontal alignment as string.  Will be one of</span>
<span class="sd">        &#39;left&#39;, &#39;center&#39; or &#39;right&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span></div>

<div class="viewcode-block" id="Text.get_unitless_position"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_unitless_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_unitless_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Return the unitless position of the text as a tuple (*x*, *y*)&quot;</span>
        <span class="c1"># This will get the position with all unit information stripped away.</span>
        <span class="c1"># This is here for convenience since it is done in several locations.</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span></div>

<div class="viewcode-block" id="Text.get_position"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Return the position of the text as a tuple (*x*, *y*)&quot;</span>
        <span class="c1"># This should return the same data (possible unitized) as was</span>
        <span class="c1"># specified with &#39;set_x&#39; and &#39;set_y&#39;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span></div>

<div class="viewcode-block" id="Text.get_prop_tup"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_prop_tup">[docs]</a>    <span class="k">def</span> <span class="nf">get_prop_tup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a hashable tuple of properties.</span>

<span class="sd">        Not intended to be human readable, but useful for backends who</span>
<span class="sd">        want to cache derived information about text (e.g., layouts) and</span>
<span class="sd">        need to know if the text has changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unitless_position</span><span class="p">()</span>
        <span class="n">renderer</span> <span class="o">=</span> <span class="n">renderer</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_color</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span><span class="p">,</span>
                <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation_mode</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span><span class="p">,</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">renderer</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="Text.get_text"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_text">[docs]</a>    <span class="k">def</span> <span class="nf">get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Get the text as string&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span></div>

<div class="viewcode-block" id="Text.get_verticalalignment"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_verticalalignment">[docs]</a>    <span class="k">def</span> <span class="nf">get_verticalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the vertical alignment as string.  Will be one of</span>
<span class="sd">        &#39;top&#39;, &#39;center&#39;, &#39;bottom&#39; or &#39;baseline&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span></div>

<div class="viewcode-block" id="Text.get_window_extent"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_window_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the `Bbox` bounding the text, in display units.</span>

<span class="sd">        In addition to being used internally, this is useful for specifying</span>
<span class="sd">        clickable regions in a png file on a web page.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        renderer : Renderer, optional</span>
<span class="sd">            A renderer is needed to compute the bounding box.  If the artist</span>
<span class="sd">            has already been drawn, the renderer is cached; thus, it is only</span>
<span class="sd">            necessary to pass this argument when calling `get_window_extent`</span>
<span class="sd">            before the first `draw`.  In practice, it is usually easier to</span>
<span class="sd">            trigger a draw first (e.g. by saving the figure).</span>

<span class="sd">        dpi : float, optional</span>
<span class="sd">            The dpi value for computing the bbox, defaults to</span>
<span class="sd">            ``self.figure.dpi`` (*not* the renderer dpi); should be set e.g. if</span>
<span class="sd">            to match regions with a figure saved with a custom dpi value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#return _unit_box</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dpi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dpi_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">dpi</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_display</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="n">renderer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">_cachedRenderer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Cannot get window extent w/o renderer&#39;</span><span class="p">)</span>

        <span class="n">bbox</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">descent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_layout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unitless_position</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">translated</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dpi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">dpi_orig</span>
        <span class="k">return</span> <span class="n">bbox</span></div>

<div class="viewcode-block" id="Text.set_backgroundcolor"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_backgroundcolor">[docs]</a>    <span class="k">def</span> <span class="nf">set_backgroundcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the background color of the text by updating the bbox.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : color</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .set_bbox : To change the position of the bounding box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_bbox</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_color"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_color">[docs]</a>    <span class="k">def</span> <span class="nf">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the foreground color of the text</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : color</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Make sure it is hashable, or get_prop_tup will fail.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">hash</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_color</span> <span class="o">=</span> <span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_horizontalalignment"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_horizontalalignment">[docs]</a>    <span class="k">def</span> <span class="nf">set_horizontalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">align</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the horizontal alignment to one of</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        align : {&#39;center&#39;, &#39;right&#39;, &#39;left&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cbook</span><span class="o">.</span><span class="n">_check_in_list</span><span class="p">([</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span> <span class="o">=</span> <span class="n">align</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_multialignment"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_multialignment">[docs]</a>    <span class="k">def</span> <span class="nf">set_multialignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">align</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the alignment for multiple lines layout.  The layout of the</span>
<span class="sd">        bounding box of all the lines is determined by the horizontalalignment</span>
<span class="sd">        and verticalalignment properties, but the multiline text within that</span>
<span class="sd">        box can be</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        align : {&#39;left&#39;, &#39;right&#39;, &#39;center&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cbook</span><span class="o">.</span><span class="n">_check_in_list</span><span class="p">([</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span> <span class="o">=</span> <span class="n">align</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_linespacing"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_linespacing">[docs]</a>    <span class="k">def</span> <span class="nf">set_linespacing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spacing</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the line spacing as a multiple of the font size.</span>
<span class="sd">        Default is 1.2.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        spacing : float (multiple of font size)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span> <span class="o">=</span> <span class="n">spacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontfamily"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_fontfamily">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontfamily</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font family.  May be either a single string, or a list of</span>
<span class="sd">        strings in decreasing priority.  Each string may be either a real font</span>
<span class="sd">        name or a generic font class name.  If the latter, the specific font</span>
<span class="sd">        names will be looked up in the corresponding rcParams.</span>

<span class="sd">        If a `Text` instance is constructed with ``fontfamily=None``, then the</span>
<span class="sd">        font is set to :rc:`font.family`, and the</span>
<span class="sd">        same is done when `set_fontfamily()` is called on an existing</span>
<span class="sd">        `Text` instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fontname : {FONTNAME, &#39;serif&#39;, &#39;sans-serif&#39;, &#39;cursive&#39;, &#39;fantasy&#39;, \</span>
<span class="sd">&#39;monospace&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_family</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_family</span><span class="p">(</span><span class="n">fontname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontvariant"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_fontvariant">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontvariant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variant</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font variant, either &#39;normal&#39; or &#39;small-caps&#39;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variant : {&#39;normal&#39;, &#39;small-caps&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_variant</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_variant</span><span class="p">(</span><span class="n">variant</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontstyle"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_fontstyle">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontstyle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font style.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fontstyle : {&#39;normal&#39;, &#39;italic&#39;, &#39;oblique&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_style</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">fontstyle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontsize"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_fontsize">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font size.  May be either a size string, relative to</span>
<span class="sd">        the default font size, or an absolute font size in points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fontsize : {size in points, &#39;xx-small&#39;, &#39;x-small&#39;, &#39;small&#39;, &#39;medium&#39;, \</span>
<span class="sd">&#39;large&#39;, &#39;x-large&#39;, &#39;xx-large&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontweight"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_fontweight">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontweight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weight</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font weight.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        weight : {a numeric value in range 0-1000, &#39;ultralight&#39;, &#39;light&#39;, \</span>
<span class="sd">&#39;normal&#39;, &#39;regular&#39;, &#39;book&#39;, &#39;medium&#39;, &#39;roman&#39;, &#39;semibold&#39;, &#39;demibold&#39;, \</span>
<span class="sd">&#39;demi&#39;, &#39;bold&#39;, &#39;heavy&#39;, &#39;extra bold&#39;, &#39;black&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_weight</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontstretch"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_fontstretch">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontstretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stretch</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font stretch (horizontal condensation or expansion).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stretch : {a numeric value in range 0-1000, &#39;ultra-condensed&#39;, \</span>
<span class="sd">&#39;extra-condensed&#39;, &#39;condensed&#39;, &#39;semi-condensed&#39;, &#39;normal&#39;, &#39;semi-expanded&#39;, \</span>
<span class="sd">&#39;expanded&#39;, &#39;extra-expanded&#39;, &#39;ultra-expanded&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_stretch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_stretch</span><span class="p">(</span><span class="n">stretch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_position"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_position">[docs]</a>    <span class="k">def</span> <span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the (*x*, *y*) position of the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="Text.set_x"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_x">[docs]</a>    <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the *x* position of the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_y"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_y">[docs]</a>    <span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the *y* position of the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        y : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_rotation"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_rotation">[docs]</a>    <span class="k">def</span> <span class="nf">set_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the rotation of the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : {angle in degrees, &#39;vertical&#39;, &#39;horizontal&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="n">s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_verticalalignment"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_verticalalignment">[docs]</a>    <span class="k">def</span> <span class="nf">set_verticalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">align</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the vertical alignment</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        align : {&#39;center&#39;, &#39;top&#39;, &#39;bottom&#39;, &#39;baseline&#39;, &#39;center_baseline&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cbook</span><span class="o">.</span><span class="n">_check_in_list</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;center_baseline&#39;</span><span class="p">],</span>
            <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span> <span class="o">=</span> <span class="n">align</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_text"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_text">[docs]</a>    <span class="k">def</span> <span class="nf">set_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the text string *s*.</span>

<span class="sd">        It may contain newlines (``\\n``) or math in LaTeX syntax.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : object</span>
<span class="sd">            Any object gets converted to its `str`, except ``None`` which</span>
<span class="sd">            becomes ``&#39;&#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.is_math_text"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.is_math_text">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@cbook</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;3.1&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">is_math_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a cleaned string and a boolean flag.</span>
<span class="sd">        The flag indicates if the given string *s* contains any mathtext,</span>
<span class="sd">        determined by counting unescaped dollar signs. If no mathtext</span>
<span class="sd">        is present, the cleaned string has its dollar signs unescaped.</span>
<span class="sd">        If usetex is on, the flag always has the value &quot;TeX&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Did we find an even number of non-escaped dollar signs?</span>
        <span class="c1"># If so, treat is as math text.</span>
        <span class="k">if</span> <span class="n">usetex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">usetex</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">usetex</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\ &#39;</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="s1">&#39;TeX&#39;</span>

        <span class="k">if</span> <span class="n">cbook</span><span class="o">.</span><span class="n">is_math_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$&#39;</span><span class="p">,</span> <span class="s1">&#39;$&#39;</span><span class="p">),</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">_preprocess_math</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the string *s* after mathtext preprocessing, and the kind of</span>
<span class="sd">        mathtext support needed.</span>

<span class="sd">        - If *self* is configured to use TeX, return *s* unchanged except that</span>
<span class="sd">          a single space gets escaped, and the flag &quot;TeX&quot;.</span>
<span class="sd">        - Otherwise, if *s* is mathtext (has an even number of unescaped dollar</span>
<span class="sd">          signs), return *s* and the flag True.</span>
<span class="sd">        - Otherwise, return *s* with dollar signs unescaped, and the flag</span>
<span class="sd">          False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_usetex</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\ &quot;</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;TeX&quot;</span>
        <span class="k">elif</span> <span class="n">cbook</span><span class="o">.</span><span class="n">is_math_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\$&quot;</span><span class="p">,</span> <span class="s2">&quot;$&quot;</span><span class="p">),</span> <span class="kc">False</span>

<div class="viewcode-block" id="Text.set_fontproperties"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_fontproperties">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontproperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font properties that control the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fp : `.font_manager.FontProperties`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">FontProperties</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_usetex"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_usetex">[docs]</a>    <span class="k">def</span> <span class="nf">set_usetex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usetex</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        usetex : bool or None</span>
<span class="sd">            Whether to render using TeX, ``None`` means to use</span>
<span class="sd">            :rc:`text.usetex`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">usetex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_usetex</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_usetex</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">usetex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.get_usetex"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.get_usetex">[docs]</a>    <span class="k">def</span> <span class="nf">get_usetex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether this `Text` object uses TeX for rendering.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_usetex</span></div>

<div class="viewcode-block" id="Text.set_fontname"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Text.set_fontname">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Alias for `set_family`.</span>

<span class="sd">        One-way alias only: the getter differs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fontname : {FONTNAME, &#39;serif&#39;, &#39;sans-serif&#39;, &#39;cursive&#39;, &#39;fantasy&#39;, \</span>
<span class="sd">&#39;monospace&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_family</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_family</span><span class="p">(</span><span class="n">fontname</span><span class="p">)</span></div></div>


<span class="n">docstring</span><span class="o">.</span><span class="n">interpd</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Text</span><span class="o">=</span><span class="n">artist</span><span class="o">.</span><span class="n">kwdoc</span><span class="p">(</span><span class="n">Text</span><span class="p">))</span>
<span class="n">docstring</span><span class="o">.</span><span class="n">dedent_interpd</span><span class="p">(</span><span class="n">Text</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span>


<div class="viewcode-block" id="TextWithDash"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash">[docs]</a><span class="nd">@cbook</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;3.1&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;Annotation&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TextWithDash</span><span class="p">(</span><span class="n">Text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is basically a :class:`~matplotlib.text.Text` with a dash</span>
<span class="sd">    (drawn with a :class:`~matplotlib.lines.Line2D`) before/after</span>
<span class="sd">    it. It is intended to be a drop-in replacement for</span>
<span class="sd">    :class:`~matplotlib.text.Text`, and should behave identically to</span>
<span class="sd">    it when *dashlength* = 0.0.</span>

<span class="sd">    The dash always comes between the point specified by</span>
<span class="sd">    :meth:`~matplotlib.text.Text.set_position` and the text. When a</span>
<span class="sd">    dash exists, the text alignment arguments (*horizontalalignment*,</span>
<span class="sd">    *verticalalignment*) are ignored.</span>

<span class="sd">    *dashlength* is the length of the dash in canvas units.</span>
<span class="sd">    (default = 0.0).</span>

<span class="sd">    *dashdirection* is one of 0 or 1, where 0 draws the dash after the</span>
<span class="sd">    text and 1 before.  (default = 0).</span>

<span class="sd">    *dashrotation* specifies the rotation of the dash, and should</span>
<span class="sd">    generally stay *None*. In this case</span>
<span class="sd">    :meth:`~matplotlib.text.TextWithDash.get_dashrotation` returns</span>
<span class="sd">    :meth:`~matplotlib.text.Text.get_rotation`.  (i.e., the dash takes</span>
<span class="sd">    its rotation from the text&#39;s rotation). Because the text center is</span>
<span class="sd">    projected onto the dash, major deviations in the rotation cause</span>
<span class="sd">    what may be considered visually unappealing results.</span>
<span class="sd">    (default = *None*)</span>

<span class="sd">    *dashpad* is a padding length to add (or subtract) space</span>
<span class="sd">    between the text and the dash, in canvas units.</span>
<span class="sd">    (default = 3)</span>

<span class="sd">    *dashpush* &quot;pushes&quot; the dash and text away from the point</span>
<span class="sd">    specified by :meth:`~matplotlib.text.Text.set_position` by the</span>
<span class="sd">    amount in canvas units.  (default = 0)</span>

<span class="sd">    .. note::</span>

<span class="sd">        The alignment of the two objects is based on the bounding box</span>
<span class="sd">        of the :class:`~matplotlib.text.Text`, as obtained by</span>
<span class="sd">        :meth:`~matplotlib.artist.Artist.get_window_extent`.  This, in</span>
<span class="sd">        turn, appears to depend on the font metrics as given by the</span>
<span class="sd">        rendering backend. Hence the quality of the &quot;centering&quot; of the</span>
<span class="sd">        label text with respect to the dash varies depending on the</span>
<span class="sd">        backend used.</span>

<span class="sd">    .. note::</span>

<span class="sd">        I&#39;m not sure that I got the</span>
<span class="sd">        :meth:`~matplotlib.text.TextWithDash.get_window_extent` right,</span>
<span class="sd">        or whether that&#39;s sufficient for providing the object bounding</span>
<span class="sd">        box.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__name__</span> <span class="o">=</span> <span class="s1">&#39;textwithdash&#39;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;TextWithDash(</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, </span><span class="si">%r</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>          <span class="c1"># defaults to rc params</span>
                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">multialignment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">fontproperties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># defaults to FontProperties()</span>
                 <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">linespacing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dashlength</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="n">dashdirection</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">dashrotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dashpad</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                 <span class="n">dashpush</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="p">):</span>

        <span class="n">Text</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                      <span class="n">verticalalignment</span><span class="o">=</span><span class="n">verticalalignment</span><span class="p">,</span>
                      <span class="n">horizontalalignment</span><span class="o">=</span><span class="n">horizontalalignment</span><span class="p">,</span>
                      <span class="n">multialignment</span><span class="o">=</span><span class="n">multialignment</span><span class="p">,</span>
                      <span class="n">fontproperties</span><span class="o">=</span><span class="n">fontproperties</span><span class="p">,</span>
                      <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">,</span>
                      <span class="n">linespacing</span><span class="o">=</span><span class="n">linespacing</span><span class="p">,</span>
                      <span class="p">)</span>

        <span class="c1"># The position (x,y) values for text and dashline</span>
        <span class="c1"># are bogus as given in the instantiation; they will</span>
        <span class="c1"># be set correctly by update_coords() in draw()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dashline</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">(</span><span class="n">xdata</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
                               <span class="n">ydata</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
                               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                               <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dashx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashlength</span> <span class="o">=</span> <span class="n">dashlength</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashdirection</span> <span class="o">=</span> <span class="n">dashdirection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashrotation</span> <span class="o">=</span> <span class="n">dashrotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashpad</span> <span class="o">=</span> <span class="n">dashpad</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashpush</span> <span class="o">=</span> <span class="n">dashpush</span>

        <span class="c1">#self.set_bbox(dict(pad=0))</span>

<div class="viewcode-block" id="TextWithDash.get_unitless_position"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_unitless_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_unitless_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Return the unitless position of the text as a tuple (*x*, *y*)&quot;</span>
        <span class="c1"># This will get the position with all unit information stripped away.</span>
        <span class="c1"># This is here for convenience since it is done in several locations.</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dashx</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dashy</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span></div>

<div class="viewcode-block" id="TextWithDash.get_position"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Return the position of the text as a tuple (*x*, *y*)&quot;</span>
        <span class="c1"># This should return the same data (possibly unitized) as was</span>
        <span class="c1"># specified with set_x and set_y</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashy</span></div>

<div class="viewcode-block" id="TextWithDash.get_prop_tup"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_prop_tup">[docs]</a>    <span class="k">def</span> <span class="nf">get_prop_tup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a hashable tuple of properties.</span>

<span class="sd">        Not intended to be human readable, but useful for backends who</span>
<span class="sd">        want to cache derived information about text (e.g., layouts) and</span>
<span class="sd">        need to know if the text has changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">props</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_prop_tup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">)]</span>
        <span class="n">props</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashlength</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_dashdirection</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashrotation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashpad</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_dashpush</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">props</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextWithDash.draw"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.draw">[docs]</a>    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the :class:`TextWithDash` object to the given *renderer*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_coords</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="n">Text</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dashlength</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dashline</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="TextWithDash.update_coords"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.update_coords">[docs]</a>    <span class="k">def</span> <span class="nf">update_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the actual *x*, *y* coordinates for text based on the</span>
<span class="sd">        input *x*, *y* and the *dashlength*. Since the rotation is</span>
<span class="sd">        with respect to the actual canvas&#39;s coordinates we need to map</span>
<span class="sd">        back and forth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dashx</span><span class="p">,</span> <span class="n">dashy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unitless_position</span><span class="p">()</span>
        <span class="n">dashlength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dashlength</span><span class="p">()</span>
        <span class="c1"># Shortcircuit this process if we don&#39;t have a dash</span>
        <span class="k">if</span> <span class="n">dashlength</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">dashx</span><span class="p">,</span> <span class="n">dashy</span>
            <span class="k">return</span>

        <span class="n">dashrotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dashrotation</span><span class="p">()</span>
        <span class="n">dashdirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dashdirection</span><span class="p">()</span>
        <span class="n">dashpad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dashpad</span><span class="p">()</span>
        <span class="n">dashpush</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dashpush</span><span class="p">()</span>

        <span class="n">angle</span> <span class="o">=</span> <span class="n">get_rotation</span><span class="p">(</span><span class="n">dashrotation</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">angle</span> <span class="o">/</span> <span class="mf">180.0</span> <span class="o">+</span> <span class="n">dashdirection</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">cos_theta</span><span class="p">,</span> <span class="n">sin_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span>

        <span class="c1"># Compute the dash end points</span>
        <span class="c1"># The &#39;c&#39; prefix is for canvas coordinates</span>
        <span class="n">cxy</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">dashx</span><span class="p">,</span> <span class="n">dashy</span><span class="p">))</span>
        <span class="n">cd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cos_theta</span><span class="p">,</span> <span class="n">sin_theta</span><span class="p">])</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">cxy</span> <span class="o">+</span> <span class="n">dashpush</span> <span class="o">*</span> <span class="n">cd</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">cxy</span> <span class="o">+</span> <span class="p">(</span><span class="n">dashpush</span> <span class="o">+</span> <span class="n">dashlength</span><span class="p">)</span> <span class="o">*</span> <span class="n">cd</span>

        <span class="n">inverse</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>
        <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">inverse</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">c1</span><span class="p">))</span>
        <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">=</span> <span class="n">inverse</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">c2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dashline</span><span class="o">.</span><span class="n">set_data</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>

        <span class="c1"># We now need to extend this vector out to</span>
        <span class="c1"># the center of the text area.</span>
        <span class="c1"># The basic problem here is that we&#39;re &quot;rotating&quot;</span>
        <span class="c1"># two separate objects but want it to appear as</span>
        <span class="c1"># if they&#39;re rotated together.</span>
        <span class="c1"># This is made non-trivial because of the</span>
        <span class="c1"># interaction between text rotation and alignment -</span>
        <span class="c1"># text alignment is based on the bbox after rotation.</span>
        <span class="c1"># We reset/force both alignments to &#39;center&#39;</span>
        <span class="c1"># so we can do something relatively reasonable.</span>
        <span class="c1"># There&#39;s probably a better way to do this by</span>
        <span class="c1"># embedding all this in the object&#39;s transformations,</span>
        <span class="c1"># but I don&#39;t grok the transformation stuff</span>
        <span class="c1"># well enough yet.</span>
        <span class="n">we</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">)</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">we</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">we</span><span class="o">.</span><span class="n">height</span>
        <span class="c1"># Watch for zeros</span>
        <span class="k">if</span> <span class="n">sin_theta</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">w</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="n">cos_theta</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">h</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tan_theta</span> <span class="o">=</span> <span class="n">sin_theta</span> <span class="o">/</span> <span class="n">cos_theta</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">w</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">tan_theta</span>
            <span class="k">if</span> <span class="n">dy</span> <span class="o">&gt;</span> <span class="n">h</span> <span class="ow">or</span> <span class="n">dy</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">h</span><span class="p">:</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="n">h</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="n">h</span> <span class="o">/</span> <span class="n">tan_theta</span>
        <span class="n">cwd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">cwd</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">dashpad</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">cwd</span><span class="p">))</span>
        <span class="n">cw</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">+</span> <span class="p">(</span><span class="n">dashdirection</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">cwd</span>

        <span class="n">newx</span><span class="p">,</span> <span class="n">newy</span> <span class="o">=</span> <span class="n">inverse</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">cw</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">newx</span><span class="p">,</span> <span class="n">newy</span>

        <span class="c1"># Now set the window extent</span>
        <span class="c1"># I&#39;m not at all sure this is the right way to do this.</span>
        <span class="n">we</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_twd_window_extent</span> <span class="o">=</span> <span class="n">we</span><span class="o">.</span><span class="n">frozen</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_twd_window_extent</span><span class="o">.</span><span class="n">update_from_data_xy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c1</span><span class="p">]),</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Finally, make text align center</span>
        <span class="n">Text</span><span class="o">.</span><span class="n">set_horizontalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">Text</span><span class="o">.</span><span class="n">set_verticalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextWithDash.get_window_extent"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_window_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return a :class:`~matplotlib.transforms.Bbox` object bounding</span>
<span class="sd">        the text, in display units.</span>

<span class="sd">        In addition to being used internally, this is useful for</span>
<span class="sd">        specifying clickable regions in a png file on a web page.</span>

<span class="sd">        *renderer* defaults to the _renderer attribute of the text</span>
<span class="sd">        object.  This is not assigned until the first execution of</span>
<span class="sd">        :meth:`draw`, so you must use this kwarg if you want</span>
<span class="sd">        to call :meth:`get_window_extent` prior to the first</span>
<span class="sd">        :meth:`draw`.  For getting web page regions, it is</span>
<span class="sd">        simpler to call the method after saving the figure.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_coords</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dashlength</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_twd_window_extent</span></div>

<div class="viewcode-block" id="TextWithDash.get_dashlength"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_dashlength">[docs]</a>    <span class="k">def</span> <span class="nf">get_dashlength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the length of the dash.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashlength</span></div>

<div class="viewcode-block" id="TextWithDash.set_dashlength"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_dashlength">[docs]</a>    <span class="k">def</span> <span class="nf">set_dashlength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the length of the dash, in canvas units.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dl : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashlength</span> <span class="o">=</span> <span class="n">dl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="TextWithDash.get_dashdirection"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_dashdirection">[docs]</a>    <span class="k">def</span> <span class="nf">get_dashdirection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the direction dash.  1 is before the text and 0 is after.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashdirection</span></div>

<div class="viewcode-block" id="TextWithDash.set_dashdirection"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_dashdirection">[docs]</a>    <span class="k">def</span> <span class="nf">set_dashdirection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the direction of the dash following the text.  1 is before the text</span>
<span class="sd">        and 0 is after. The default is 0, which is what you&#39;d want for the</span>
<span class="sd">        typical case of ticks below and on the left of the figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dd : int (1 is before, 0 is after)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashdirection</span> <span class="o">=</span> <span class="n">dd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="TextWithDash.get_dashrotation"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_dashrotation">[docs]</a>    <span class="k">def</span> <span class="nf">get_dashrotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the rotation of the dash in degrees.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashrotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashrotation</span></div>

<div class="viewcode-block" id="TextWithDash.set_dashrotation"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_dashrotation">[docs]</a>    <span class="k">def</span> <span class="nf">set_dashrotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the rotation of the dash, in degrees.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dr : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashrotation</span> <span class="o">=</span> <span class="n">dr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="TextWithDash.get_dashpad"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_dashpad">[docs]</a>    <span class="k">def</span> <span class="nf">get_dashpad</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the extra spacing between the dash and the text, in canvas units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashpad</span></div>

<div class="viewcode-block" id="TextWithDash.set_dashpad"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_dashpad">[docs]</a>    <span class="k">def</span> <span class="nf">set_dashpad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the &quot;pad&quot; of the TextWithDash, which is the extra spacing</span>
<span class="sd">        between the dash and the text, in canvas units.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dp : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashpad</span> <span class="o">=</span> <span class="n">dp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="TextWithDash.get_dashpush"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_dashpush">[docs]</a>    <span class="k">def</span> <span class="nf">get_dashpush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the extra spacing between the dash and the specified text</span>
<span class="sd">        position, in canvas units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashpush</span></div>

<div class="viewcode-block" id="TextWithDash.set_dashpush"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_dashpush">[docs]</a>    <span class="k">def</span> <span class="nf">set_dashpush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the &quot;push&quot; of the TextWithDash, which is the extra spacing between</span>
<span class="sd">        the beginning of the dash and the specified position.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dp : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashpush</span> <span class="o">=</span> <span class="n">dp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="TextWithDash.set_position"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_position">[docs]</a>    <span class="k">def</span> <span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the (*x*, *y*) position of the :class:`TextWithDash`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="TextWithDash.set_x"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_x">[docs]</a>    <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the *x* position of the :class:`TextWithDash`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="TextWithDash.set_y"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_y">[docs]</a>    <span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the *y* position of the :class:`TextWithDash`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        y : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dashy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="TextWithDash.set_transform"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_transform">[docs]</a>    <span class="k">def</span> <span class="nf">set_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the :class:`matplotlib.transforms.Transform` instance used</span>
<span class="sd">        by this artist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t : `~matplotlib.transforms.Transform`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Text</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dashline</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="TextWithDash.get_figure"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.get_figure">[docs]</a>    <span class="k">def</span> <span class="nf">get_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the figure instance the artist belongs to.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span></div>

<div class="viewcode-block" id="TextWithDash.set_figure"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.TextWithDash.set_figure">[docs]</a>    <span class="k">def</span> <span class="nf">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the figure instance the artist belongs to.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fig : `~matplotlib.figure.Figure`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Text</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dashline</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div></div>

<span class="n">docstring</span><span class="o">.</span><span class="n">interpd</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">TextWithDash</span><span class="o">=</span><span class="n">artist</span><span class="o">.</span><span class="n">kwdoc</span><span class="p">(</span><span class="n">TextWithDash</span><span class="p">))</span>


<div class="viewcode-block" id="OffsetFrom"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.OffsetFrom">[docs]</a><span class="k">class</span> <span class="nc">OffsetFrom</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s1">&#39;Callable helper class for working with `Annotation`&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">ref_coord</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;points&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        artist : `Artist`, `BboxBase`, or `Transform`</span>
<span class="sd">            The object to compute the offset from.</span>

<span class="sd">        ref_coord : length 2 sequence</span>
<span class="sd">            If `artist` is an `Artist` or `BboxBase`, this values is</span>
<span class="sd">            the location to of the offset origin in fractions of the</span>
<span class="sd">            `artist` bounding box.</span>

<span class="sd">            If `artist` is a transform, the offset origin is the</span>
<span class="sd">            transform applied to this value.</span>

<span class="sd">        unit : {&#39;points, &#39;pixels&#39;}</span>
<span class="sd">            The screen units to use (pixels or points) for the offset</span>
<span class="sd">            input.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_artist</span> <span class="o">=</span> <span class="n">artist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ref_coord</span> <span class="o">=</span> <span class="n">ref_coord</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

<div class="viewcode-block" id="OffsetFrom.set_unit"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.OffsetFrom.set_unit">[docs]</a>    <span class="k">def</span> <span class="nf">set_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The unit for input to the transform used by ``__call__``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        unit : {&#39;points&#39;, &#39;pixels&#39;}</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">cbook</span><span class="o">.</span><span class="n">_check_in_list</span><span class="p">([</span><span class="s2">&quot;points&quot;</span><span class="p">,</span> <span class="s2">&quot;pixels&quot;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span> <span class="o">=</span> <span class="n">unit</span></div>

<div class="viewcode-block" id="OffsetFrom.get_unit"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.OffsetFrom.get_unit">[docs]</a>    <span class="k">def</span> <span class="nf">get_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s1">&#39;The unit for input to the transform used by ``__call__``&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span></div>

    <span class="k">def</span> <span class="nf">_get_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;pixels&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the offset transform.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        renderer : `RendererBase`</span>
<span class="sd">            The renderer to use to compute the offset</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        transform : `Transform`</span>
<span class="sd">            Maps (x, y) in pixel or point units to screen units</span>
<span class="sd">            relative to the given artist.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="p">,</span> <span class="n">Artist</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">bounds</span>
            <span class="n">xf</span><span class="p">,</span> <span class="n">yf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_coord</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">w</span> <span class="o">*</span> <span class="n">xf</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">yf</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="p">,</span> <span class="n">BboxBase</span><span class="p">):</span>
            <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="o">.</span><span class="n">bounds</span>
            <span class="n">xf</span><span class="p">,</span> <span class="n">yf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_coord</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">w</span> <span class="o">*</span> <span class="n">xf</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">yf</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref_coord</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;unknown type&quot;</span><span class="p">)</span>

        <span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scale</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tr</span></div>


<span class="k">class</span> <span class="nc">_AnnotationBase</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">xy</span><span class="p">,</span>
                 <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                 <span class="n">annotation_clip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span> <span class="o">=</span> <span class="n">xycoords</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_annotation_clip</span><span class="p">(</span><span class="n">annotation_clip</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span>

        <span class="k">if</span> <span class="n">s1</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">s2</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

        <span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_transform</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>

    <span class="k">def</span> <span class="nf">_get_xy_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s</span>
            <span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">blended_transform_factory</span>
            <span class="n">tr1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_transform</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
            <span class="n">tr2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_transform</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">tr1</span><span class="p">,</span> <span class="n">tr2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tr</span>
        <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">BboxBase</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">BboxTransformTo</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">tr</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;unknown return type ...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Artist</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">BboxTransformTo</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">BboxBase</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">BboxTransformTo</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;unknown coordinate type : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">s</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;polar&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">matplotlib.projections</span> <span class="kn">import</span> <span class="n">PolarAxes</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">PolarAxes</span><span class="o">.</span><span class="n">PolarTransform</span><span class="p">()</span>
            <span class="n">trans</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span>
            <span class="k">return</span> <span class="n">trans</span>

        <span class="n">s_</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a recognized coordinate&quot;</span> <span class="o">%</span> <span class="n">s</span><span class="p">)</span>

        <span class="n">bbox0</span><span class="p">,</span> <span class="n">xy0</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">bbox_name</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">s_</span>
        <span class="c1"># if unit is offset-like</span>
        <span class="k">if</span> <span class="n">bbox_name</span> <span class="o">==</span> <span class="s2">&quot;figure&quot;</span><span class="p">:</span>
            <span class="n">bbox0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">bbox</span>
        <span class="k">elif</span> <span class="n">bbox_name</span> <span class="o">==</span> <span class="s2">&quot;axes&quot;</span><span class="p">:</span>
            <span class="n">bbox0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span>
        <span class="c1"># elif bbox_name == &quot;bbox&quot;:</span>
        <span class="c1">#     if bbox is None:</span>
        <span class="c1">#         raise RuntimeError(&quot;bbox is specified as a coordinate but &quot;</span>
        <span class="c1">#                            &quot;never set&quot;)</span>
        <span class="c1">#     bbox0 = self._get_bbox(renderer, bbox)</span>

        <span class="k">if</span> <span class="n">bbox0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xy0</span> <span class="o">=</span> <span class="n">bbox0</span><span class="o">.</span><span class="n">bounds</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">bbox_name</span> <span class="o">==</span> <span class="s2">&quot;offset&quot;</span><span class="p">:</span>
            <span class="n">xy0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ref_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xy0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># reference x, y in display coordinate</span>
            <span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span> <span class="o">=</span> <span class="n">xy0</span>
            <span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Affine2D</span>
            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;points&quot;</span><span class="p">:</span>
                <span class="c1"># dots per points</span>
                <span class="n">dpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span> <span class="o">/</span> <span class="mf">72.</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">dpp</span><span class="p">,</span> <span class="n">dpp</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;pixels&quot;</span><span class="p">:</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;fontsize&quot;</span><span class="p">:</span>
                <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
                <span class="n">dpp</span> <span class="o">=</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span> <span class="o">/</span> <span class="mf">72.</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">dpp</span><span class="p">,</span> <span class="n">dpp</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;fraction&quot;</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">bbox0</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a recognized coordinate&quot;</span> <span class="o">%</span> <span class="n">s</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">tr</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a recognized coordinate&quot;</span> <span class="o">%</span> <span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_ref_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return x, y (in display coordinate) that is to be used for a reference</span>
<span class="sd">        of any offset coordinate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">is_offset</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;offset&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span>
            <span class="k">if</span> <span class="n">is_offset</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_offset</span><span class="p">(</span><span class="n">s2</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;xycoords should not be an offset coordinate&quot;</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span>
        <span class="k">elif</span> <span class="n">is_offset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;xycoords should not be an offset coordinate&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span><span class="p">)</span>
        <span class="c1">#raise RuntimeError(&quot;must be defined by the derived class&quot;)</span>

    <span class="c1"># def _get_bbox(self, renderer):</span>
    <span class="c1">#     if hasattr(bbox, &quot;bounds&quot;):</span>
    <span class="c1">#         return bbox</span>
    <span class="c1">#     elif hasattr(bbox, &quot;get_window_extent&quot;):</span>
    <span class="c1">#         bbox = bbox.get_window_extent()</span>
    <span class="c1">#         return bbox</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         raise ValueError(&quot;A bbox instance is expected but got %s&quot; %</span>
    <span class="c1">#                          str(bbox))</span>

    <span class="k">def</span> <span class="nf">set_annotation_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set *annotation_clip* attribute.</span>

<span class="sd">          * True: the annotation will only be drawn when self.xy is inside</span>
<span class="sd">                  the axes.</span>
<span class="sd">          * False: the annotation will always be drawn regardless of its</span>
<span class="sd">                   position.</span>
<span class="sd">          * None: the self.xy will be checked only if *xycoords* is &quot;data&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_annotation_clip</span> <span class="o">=</span> <span class="n">b</span>

    <span class="k">def</span> <span class="nf">get_annotation_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return *annotation_clip* attribute.</span>
<span class="sd">        See :meth:`set_annotation_clip` for the meaning of return values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_annotation_clip</span>

    <span class="k">def</span> <span class="nf">_get_position_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="s2">&quot;Return the pixel position of the annotated point.&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">xy_pixel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        given the xy pixel coordinate, check if the annotation need to</span>
<span class="sd">        be drawn.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_annotation_clip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">b</span> <span class="ow">or</span> <span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span> <span class="o">==</span> <span class="s2">&quot;data&quot;</span><span class="p">):</span>
            <span class="c1"># check if self.xy is inside the axes.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">contains_point</span><span class="p">(</span><span class="n">xy_pixel</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">draggable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_blit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the draggable state -- if state is</span>

<span class="sd">          * None : toggle the current state</span>

<span class="sd">          * True : turn draggable on</span>

<span class="sd">          * False : turn draggable off</span>

<span class="sd">        If draggable is on, you can drag the annotation on the canvas with</span>
<span class="sd">        the mouse.  The DraggableAnnotation helper instance is returned if</span>
<span class="sd">        draggable is on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">matplotlib.offsetbox</span> <span class="kn">import</span> <span class="n">DraggableAnnotation</span>
        <span class="n">is_draggable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="c1"># if state is None we&#39;ll toggle</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">is_draggable</span>

        <span class="k">if</span> <span class="n">state</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="o">=</span> <span class="n">DraggableAnnotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_blit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span>


<div class="viewcode-block" id="Annotation"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Annotation">[docs]</a><span class="k">class</span> <span class="nc">Annotation</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="n">_AnnotationBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An `.Annotation` is a `.Text` that can refer to a specific position *xy*.</span>
<span class="sd">    Optionally an arrow pointing from the text to *xy* can be drawn.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    xy</span>
<span class="sd">        The annotated position.</span>
<span class="sd">    xycoords</span>
<span class="sd">        The coordinate system for *xy*.</span>
<span class="sd">    arrow_patch</span>
<span class="sd">        A `.FancyArrowPatch` to point from *xytext* to *xy*.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Annotation(</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, </span><span class="si">%r</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">)</span>

    <span class="nd">@cbook</span><span class="o">.</span><span class="n">_rename_parameter</span><span class="p">(</span><span class="s2">&quot;3.1&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span>
                 <span class="n">xytext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                 <span class="n">textcoords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">arrowprops</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">annotation_clip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Annotate the point *xy* with text *text*.</span>

<span class="sd">        In the simplest form, the text is placed at *xy*.</span>

<span class="sd">        Optionally, the text can be displayed in another position *xytext*.</span>
<span class="sd">        An arrow pointing from the text to the annotated point *xy* can then</span>
<span class="sd">        be added by defining *arrowprops*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            The text of the annotation.  *s* is a deprecated synonym for this</span>
<span class="sd">            parameter.</span>

<span class="sd">        xy : (float, float)</span>
<span class="sd">            The point *(x,y)* to annotate.</span>

<span class="sd">        xytext : (float, float), optional</span>
<span class="sd">            The position *(x,y)* to place the text at.</span>
<span class="sd">            If *None*, defaults to *xy*.</span>

<span class="sd">        xycoords : str, `.Artist`, `.Transform`, callable or tuple, optional</span>

<span class="sd">            The coordinate system that *xy* is given in. The following types</span>
<span class="sd">            of values are supported:</span>

<span class="sd">            - One of the following strings:</span>

<span class="sd">              =================   =============================================</span>
<span class="sd">              Value               Description</span>
<span class="sd">              =================   =============================================</span>
<span class="sd">              &#39;figure points&#39;     Points from the lower left of the figure</span>
<span class="sd">              &#39;figure pixels&#39;     Pixels from the lower left of the figure</span>
<span class="sd">              &#39;figure fraction&#39;   Fraction of figure from lower left</span>
<span class="sd">              &#39;axes points&#39;       Points from lower left corner of axes</span>
<span class="sd">              &#39;axes pixels&#39;       Pixels from lower left corner of axes</span>
<span class="sd">              &#39;axes fraction&#39;     Fraction of axes from lower left</span>
<span class="sd">              &#39;data&#39;              Use the coordinate system of the object being</span>
<span class="sd">                                  annotated (default)</span>
<span class="sd">              &#39;polar&#39;             *(theta,r)* if not native &#39;data&#39; coordinates</span>
<span class="sd">              =================   =============================================</span>

<span class="sd">            - An `.Artist`: *xy* is interpreted as a fraction of the artists</span>
<span class="sd">              `~matplotlib.transforms.Bbox`. E.g. *(0, 0)* would be the lower</span>
<span class="sd">              left corner of the bounding box and *(0.5, 1)* would be the</span>
<span class="sd">              center top of the bounding box.</span>

<span class="sd">            - A `.Transform` to transform *xy* to screen coordinates.</span>

<span class="sd">            - A function with one of the following signatures::</span>

<span class="sd">                def transform(renderer) -&gt; Bbox</span>
<span class="sd">                def transform(renderer) -&gt; Transform</span>

<span class="sd">              where *renderer* is a `.RendererBase` subclass.</span>

<span class="sd">              The result of the function is interpreted like the `.Artist` and</span>
<span class="sd">              `.Transform` cases above.</span>

<span class="sd">            - A tuple *(xcoords, ycoords)* specifying separate coordinate</span>
<span class="sd">              systems for *x* and *y*. *xcoords* and *ycoords* must each be</span>
<span class="sd">              of one of the above described types.</span>

<span class="sd">            See :ref:`plotting-guide-annotation` for more details.</span>

<span class="sd">            Defaults to &#39;data&#39;.</span>

<span class="sd">        textcoords : str, `.Artist`, `.Transform`, callable or tuple, optional</span>
<span class="sd">            The coordinate system that *xytext* is given in.</span>

<span class="sd">            All *xycoords* values are valid as well as the following</span>
<span class="sd">            strings:</span>

<span class="sd">            =================   =========================================</span>
<span class="sd">            Value               Description</span>
<span class="sd">            =================   =========================================</span>
<span class="sd">            &#39;offset points&#39;     Offset (in points) from the *xy* value</span>
<span class="sd">            &#39;offset pixels&#39;     Offset (in pixels) from the *xy* value</span>
<span class="sd">            =================   =========================================</span>

<span class="sd">            Defaults to the value of *xycoords*, i.e. use the same coordinate</span>
<span class="sd">            system for annotation point and text position.</span>

<span class="sd">        arrowprops : dict, optional</span>
<span class="sd">            The properties used to draw a</span>
<span class="sd">            `~matplotlib.patches.FancyArrowPatch` arrow between the</span>
<span class="sd">            positions *xy* and *xytext*.</span>

<span class="sd">            If *arrowprops* does not contain the key &#39;arrowstyle&#39; the</span>
<span class="sd">            allowed keys are:</span>

<span class="sd">            ==========   ======================================================</span>
<span class="sd">            Key          Description</span>
<span class="sd">            ==========   ======================================================</span>
<span class="sd">            width        The width of the arrow in points</span>
<span class="sd">            headwidth    The width of the base of the arrow head in points</span>
<span class="sd">            headlength   The length of the arrow head in points</span>
<span class="sd">            shrink       Fraction of total length to shrink from both ends</span>
<span class="sd">            ?            Any key to :class:`matplotlib.patches.FancyArrowPatch`</span>
<span class="sd">            ==========   ======================================================</span>

<span class="sd">            If *arrowprops* contains the key &#39;arrowstyle&#39; the</span>
<span class="sd">            above keys are forbidden.  The allowed values of</span>
<span class="sd">            ``&#39;arrowstyle&#39;`` are:</span>

<span class="sd">            ============   =============================================</span>
<span class="sd">            Name           Attrs</span>
<span class="sd">            ============   =============================================</span>
<span class="sd">            ``&#39;-&#39;``        None</span>
<span class="sd">            ``&#39;-&gt;&#39;``       head_length=0.4,head_width=0.2</span>
<span class="sd">            ``&#39;-[&#39;``       widthB=1.0,lengthB=0.2,angleB=None</span>
<span class="sd">            ``&#39;|-|&#39;``      widthA=1.0,widthB=1.0</span>
<span class="sd">            ``&#39;-|&gt;&#39;``      head_length=0.4,head_width=0.2</span>
<span class="sd">            ``&#39;&lt;-&#39;``       head_length=0.4,head_width=0.2</span>
<span class="sd">            ``&#39;&lt;-&gt;&#39;``      head_length=0.4,head_width=0.2</span>
<span class="sd">            ``&#39;&lt;|-&#39;``      head_length=0.4,head_width=0.2</span>
<span class="sd">            ``&#39;&lt;|-|&gt;&#39;``    head_length=0.4,head_width=0.2</span>
<span class="sd">            ``&#39;fancy&#39;``    head_length=0.4,head_width=0.4,tail_width=0.4</span>
<span class="sd">            ``&#39;simple&#39;``   head_length=0.5,head_width=0.5,tail_width=0.2</span>
<span class="sd">            ``&#39;wedge&#39;``    tail_width=0.3,shrink_factor=0.5</span>
<span class="sd">            ============   =============================================</span>

<span class="sd">            Valid keys for `~matplotlib.patches.FancyArrowPatch` are:</span>

<span class="sd">            ===============  ==================================================</span>
<span class="sd">            Key              Description</span>
<span class="sd">            ===============  ==================================================</span>
<span class="sd">            arrowstyle       the arrow style</span>
<span class="sd">            connectionstyle  the connection style</span>
<span class="sd">            relpos           default is (0.5, 0.5)</span>
<span class="sd">            patchA           default is bounding box of the text</span>
<span class="sd">            patchB           default is None</span>
<span class="sd">            shrinkA          default is 2 points</span>
<span class="sd">            shrinkB          default is 2 points</span>
<span class="sd">            mutation_scale   default is text size (in points)</span>
<span class="sd">            mutation_aspect  default is 1.</span>
<span class="sd">            ?                any key for :class:`matplotlib.patches.PathPatch`</span>
<span class="sd">            ===============  ==================================================</span>

<span class="sd">            Defaults to None, i.e. no arrow is drawn.</span>

<span class="sd">        annotation_clip : bool or None, optional</span>
<span class="sd">            Whether to draw the annotation when the annotation point *xy* is</span>
<span class="sd">            outside the axes area.</span>

<span class="sd">            - If *True*, the annotation will only be drawn when *xy* is</span>
<span class="sd">              within the axes.</span>
<span class="sd">            - If *False*, the annotation will always be drawn.</span>
<span class="sd">            - If *None*, the annotation will only be drawn when *xy* is</span>
<span class="sd">              within the axes and *xycoords* is &#39;data&#39;.</span>

<span class="sd">            Defaults to *None*.</span>

<span class="sd">        **kwargs</span>
<span class="sd">            Additional kwargs are passed to `~matplotlib.text.Text`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        annotation : `.Annotation`</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :ref:`plotting-guide-annotation`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_AnnotationBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                 <span class="n">xy</span><span class="p">,</span>
                                 <span class="n">xycoords</span><span class="o">=</span><span class="n">xycoords</span><span class="p">,</span>
                                 <span class="n">annotation_clip</span><span class="o">=</span><span class="n">annotation_clip</span><span class="p">)</span>
        <span class="c1"># warn about wonky input data</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">xytext</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="n">textcoords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="n">textcoords</span> <span class="o">!=</span> <span class="n">xycoords</span><span class="p">):</span>
            <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span><span class="s2">&quot;You have used the `textcoords` kwarg, but &quot;</span>
                                 <span class="s2">&quot;not the `xytext` kwarg.  This can lead to &quot;</span>
                                 <span class="s2">&quot;surprising results.&quot;</span><span class="p">)</span>

        <span class="c1"># clean up textcoords and assign default</span>
        <span class="k">if</span> <span class="n">textcoords</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">textcoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textcoords</span> <span class="o">=</span> <span class="n">textcoords</span>

        <span class="c1"># cleanup xytext defaults</span>
        <span class="k">if</span> <span class="n">xytext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xytext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xytext</span>

        <span class="n">Text</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">arrowprops</span> <span class="o">=</span> <span class="n">arrowprops</span>

        <span class="k">if</span> <span class="n">arrowprops</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;arrowstyle&quot;</span> <span class="ow">in</span> <span class="n">arrowprops</span><span class="p">:</span>
                <span class="n">arrowprops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrowprops</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_arrow_relpos</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;relpos&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># modified YAArrow API to be used with FancyArrowPatch</span>
                <span class="n">shapekeys</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">,</span> <span class="s1">&#39;headlength&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;shrink&#39;</span><span class="p">,</span> <span class="s1">&#39;frac&#39;</span><span class="p">)</span>
                <span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrowprops</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">shapekeys</span><span class="p">:</span>
                        <span class="n">arrowprops</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>  <span class="c1"># basic Patch properties</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="o">=</span> <span class="n">FancyArrowPatch</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                               <span class="o">**</span><span class="n">arrowprops</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Annotation.contains"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Annotation.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">contains</span><span class="p">,</span> <span class="n">tinfo</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">in_patch</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="n">contains</span> <span class="o">=</span> <span class="n">contains</span> <span class="ow">or</span> <span class="n">in_patch</span>

        <span class="k">return</span> <span class="n">contains</span><span class="p">,</span> <span class="n">tinfo</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xyann</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The the text position.</span>

<span class="sd">        See also *xytext* in `.Annotation`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>

    <span class="nd">@xyann</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">xyann</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xytext</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">xytext</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">anncoords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The coordinate system to use for `.Annotation.xyann`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_textcoords</span>

    <span class="nd">@anncoords</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">anncoords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textcoords</span> <span class="o">=</span> <span class="n">coords</span>

    <span class="n">get_anncoords</span> <span class="o">=</span> <span class="n">anncoords</span><span class="o">.</span><span class="n">fget</span>
    <span class="n">get_anncoords</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Return the coordinate system to use for `.Annotation.xyann`.</span>

<span class="s2">    See also *xycoords* in `.Annotation`.</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">set_anncoords</span> <span class="o">=</span> <span class="n">anncoords</span><span class="o">.</span><span class="n">fset</span>
    <span class="n">set_anncoords</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Set the coordinate system to use for `.Annotation.xyann`.</span>

<span class="s2">    See also *xycoords* in `.Annotation`.</span>
<span class="s2">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Annotation.set_figure"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Annotation.set_figure">[docs]</a>    <span class="k">def</span> <span class="nf">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">Artist</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span></div>

<div class="viewcode-block" id="Annotation.update_positions"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Annotation.update_positions">[docs]</a>    <span class="k">def</span> <span class="nf">update_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the pixel positions of the annotated point and the text.&quot;&quot;&quot;</span>
        <span class="n">xy_pixel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_position_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_position_xytext</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">xy_pixel</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_update_position_xytext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">xy_pixel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the pixel positions of the annotation text and the arrow patch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># generate transformation,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_transform</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">anncoords</span><span class="p">))</span>

        <span class="n">ox0</span><span class="p">,</span> <span class="n">oy0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_display</span><span class="p">()</span>
        <span class="n">ox1</span><span class="p">,</span> <span class="n">oy1</span> <span class="o">=</span> <span class="n">xy_pixel</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrowprops</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">xy_pixel</span>
            <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">w</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">h</span>
            <span class="n">xc</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span>
            <span class="n">yc</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span>

            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrowprops</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">ms</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;mutation_scale&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_mutation_scale</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;arrowstyle&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="c1"># Approximately simulate the YAArrow.</span>
                <span class="c1"># Pop its kwargs:</span>
                <span class="n">shrink</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;shrink&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
                <span class="n">headwidth</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;headwidth&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
                <span class="c1"># Ignore frac--it is useless.</span>
                <span class="n">frac</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;frac&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">frac</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span>
                        <span class="s2">&quot;&#39;frac&#39; option in &#39;arrowprops&#39; is no longer supported;&quot;</span>
                        <span class="s2">&quot; use &#39;headlength&#39; to set the head length in points.&quot;</span><span class="p">)</span>
                <span class="n">headlength</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;headlength&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

                <span class="c1"># NB: ms is in pts</span>
                <span class="n">stylekw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">head_length</span><span class="o">=</span><span class="n">headlength</span> <span class="o">/</span> <span class="n">ms</span><span class="p">,</span>
                               <span class="n">head_width</span><span class="o">=</span><span class="n">headwidth</span> <span class="o">/</span> <span class="n">ms</span><span class="p">,</span>
                               <span class="n">tail_width</span><span class="o">=</span><span class="n">width</span> <span class="o">/</span> <span class="n">ms</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_arrowstyle</span><span class="p">(</span><span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">stylekw</span><span class="p">)</span>

                <span class="c1"># using YAArrow style:</span>
                <span class="c1"># pick the x,y corner of the text bbox closest to point</span>
                <span class="c1"># annotated</span>
                <span class="n">xpos</span> <span class="o">=</span> <span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">ypos</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">yc</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

                <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">relposx</span><span class="p">)</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x0</span><span class="p">),</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">xpos</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">relposy</span><span class="p">)</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">y0</span><span class="p">),</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ypos</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_arrow_relpos</span> <span class="o">=</span> <span class="p">(</span><span class="n">relposx</span><span class="p">,</span> <span class="n">relposy</span><span class="p">)</span>

                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">))</span>
                <span class="n">shrink_pts</span> <span class="o">=</span> <span class="n">shrink</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">shrinkA</span> <span class="o">=</span> <span class="n">shrink_pts</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">shrinkB</span> <span class="o">=</span> <span class="n">shrink_pts</span>

            <span class="c1"># adjust the starting point of the arrow relative to</span>
            <span class="c1"># the textbox.</span>
            <span class="c1"># TODO : Rotation needs to be accounted.</span>
            <span class="n">relpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arrow_relpos</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
            <span class="n">ox0</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">relpos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">oy0</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">relpos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># The arrow will be drawn from (ox0, oy0) to (ox1,</span>
            <span class="c1"># oy1). It will be first clipped by patchA and patchB.</span>
            <span class="c1"># Then it will be shrunk by shrinkA and shrinkB</span>
            <span class="c1"># (in points). If patch A is not set, self.bbox_patch</span>
            <span class="c1"># is used.</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_positions</span><span class="p">((</span><span class="n">ox0</span><span class="p">,</span> <span class="n">oy0</span><span class="p">),</span> <span class="p">(</span><span class="n">ox1</span><span class="p">,</span> <span class="n">oy1</span><span class="p">))</span>

            <span class="k">if</span> <span class="s2">&quot;patchA&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_patchA</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;patchA&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_patchA</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pad</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_patchA</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                        <span class="k">return</span>

                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
                    <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">bounds</span>
                    <span class="n">l</span> <span class="o">-=</span> <span class="n">pad</span> <span class="o">/</span> <span class="mf">2.</span>
                    <span class="n">b</span> <span class="o">-=</span> <span class="n">pad</span> <span class="o">/</span> <span class="mf">2.</span>
                    <span class="n">w</span> <span class="o">+=</span> <span class="n">pad</span>
                    <span class="n">h</span> <span class="o">+=</span> <span class="n">pad</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
                                  <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
                                  <span class="n">height</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
                                  <span class="p">)</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">IdentityTransform</span><span class="p">())</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">set_clip_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_patchA</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<div class="viewcode-block" id="Annotation.draw"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Annotation.draw">[docs]</a>    <span class="nd">@artist</span><span class="o">.</span><span class="n">allow_rasterization</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the :class:`Annotation` object to the given *renderer*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="n">renderer</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">xy_pixel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_position_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">xy_pixel</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_position_xytext</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">xy_pixel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_bbox_position_size</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>   <span class="c1"># FancyArrowPatch</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">figure</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

        <span class="c1"># Draw text, including FancyBboxPatch, after FancyArrowPatch.</span>
        <span class="c1"># Otherwise, a wedge arrowstyle can land partly on top of the Bbox.</span>
        <span class="n">Text</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span></div>

<div class="viewcode-block" id="Annotation.get_window_extent"><a class="viewcode-back" href="../../api/text_api.html#matplotlib.text.Annotation.get_window_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the `Bbox` bounding the text and arrow, in display units.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        renderer : Renderer, optional</span>
<span class="sd">            A renderer is needed to compute the bounding box.  If the artist</span>
<span class="sd">            has already been drawn, the renderer is cached; thus, it is only</span>
<span class="sd">            necessary to pass this argument when calling `get_window_extent`</span>
<span class="sd">            before the first `draw`.  In practice, it is usually easier to</span>
<span class="sd">            trigger a draw first (e.g. by saving the figure).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This block is the same as in Text.get_window_extent, but we need to</span>
        <span class="c1"># set the renderer before calling update_positions().</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="n">renderer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">_cachedRenderer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Cannot get window extent w/o renderer&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_positions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span><span class="p">)</span>

        <span class="n">text_bbox</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[</span><span class="n">text_bbox</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">bboxes</span><span class="p">)</span></div>

    <span class="n">arrow</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">fget</span><span class="o">=</span><span class="n">cbook</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;3.0&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;arrow was deprecated in &quot;</span>
            <span class="s2">&quot;Matplotlib 3.0 and will be removed in 3.2. Use arrow_patch &quot;</span>
            <span class="s2">&quot;instead.&quot;</span><span class="p">)(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">fset</span><span class="o">=</span><span class="n">cbook</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;3.0&quot;</span><span class="p">)(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="kc">None</span><span class="p">))</span></div>


<span class="n">docstring</span><span class="o">.</span><span class="n">interpd</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Annotation</span><span class="o">=</span><span class="n">Annotation</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="footer">
        &copy; Copyright 2002 - 2012 John Hunter, Darren Dale, Eric Firing, Michael Droettboom and the Matplotlib development team; 2012 - 2018 The Matplotlib development team.
        <br />
      Last updated on Jan 05, 2020.
	Created using
	<a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
	Doc version v3.1.1-79-g90d53b526.
    </div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55954603-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
<footer>
</footer>
</html>